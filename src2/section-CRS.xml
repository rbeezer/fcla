<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                -->
<!--                                              -->
<!--      A First Course in Linear Algebra        -->
<!--                                              -->
<!-- Copyright (C) 2004-2017  Robert A. Beezer    -->
<!-- See the file COPYING for copying conditions. -->

<section xml:id="section-CRS" acro="CRS">
    <title>Column and Row Spaces</title>
    <introduction>
        <p>A matrix-vector product (<xref ref="definition-MVP" acro="MVP"/>) is a linear combination of the columns of the matrix and this allows us to connect matrix multiplication with systems of equations via <xref ref="theorem-SLSLC" acro="SLSLC"/>.  Row operations are linear combinations of the rows of a matrix, and of course, reduced row-echelon form (<xref ref="definition-RREF" acro="RREF"/>) is also intimately related to solving systems of equations.  In this section we will formalize these ideas with two key definitions of sets of vectors derived from a matrix.</p>
    </introduction>
    <subsection xml:id="subsection-CRS-CSSE" acro="CSSE">
        <title>Column Spaces and Systems of Equations</title>
        <p><xref ref="theorem-SLSLC" acro="SLSLC"/> showed us that there is a natural correspondence between solutions to linear systems and linear combinations of the columns of the coefficient matrix.  This idea motivates the following important definition.</p>
        <definition xml:id="definition-CSM" acro="CSM">
            <title>Column Space of a Matrix</title>
            <idx>
                <h>matrix</h>
                <h>column space</h>
            </idx>
            <statement>
                <p>Suppose that <m>A</m> is an <m>m\times n</m> matrix with columns <m>\vectorlist{A}{n}</m>.  Then the <term>column space</term> of <m>A</m>, written <m>\csp{A}</m>, is the subset of <m>\complex{m}</m> containing all linear combinations of the columns of <m>A</m>,<me>\csp{A}=\spn{\set{\vectorlist{A}{n}}}</me></p>
            </statement>
            <notation xml:id="notation-CSM" acro="CSM">
                <idx>
                    <h>column space</h>
                    <h>notation</h>
                </idx>
                <description>Column Space of a Matrix</description>
                <usage>\csp{A}</usage>
            </notation>
        </definition>
        <p>Some authors refer to the column space of a matrix as the <term>range</term>, but we will reserve this term for use with linear transformations (<xref ref="definition-RLT" acro="RLT"/>).</p>
        <p>Upon encountering any new set, the first question we ask is what objects are in the set, and which objects are not?  Here is an example of one way to answer this question, and it will motivate a theorem that will then answer the question precisely.</p>
        <example xml:id="example-CSMCS" acro="CSMCS">
            <title>Column space of a matrix and consistent systems</title>
            <idx>
                <h>column space</h>
                <h>consistent systems</h>
            </idx>
            <p>Archetype<nbsp/><xref ref="archetype-D" acro="D" text="global"/> and Archetype<nbsp/><xref ref="archetype-E" acro="E" text="global"/> are linear systems of equations, with an identical <m>3\times 4</m> coefficient matrix, which we call <m>A</m> here.  However, Archetype<nbsp/><xref ref="archetype-D" acro="D" text="global"/> is consistent, while Archetype<nbsp/><xref ref="archetype-E" acro="E" text="global"/> is not.  We can explain this difference by employing the column space of the matrix <m>A</m>.</p>
            <p>The column vector of constants, <m>\vect{b}</m>, in Archetype<nbsp/><xref ref="archetype-D" acro="D" text="global"/> is given below, and one solution listed for <m>\linearsystem{A}{\vect{b}}</m> is <m>\vect{x}</m><md>
                <mrow>\vect{b}&amp;=\colvector{8\\-12\\4}
                &amp;
                \vect{x}&amp;=\colvector{7\\8\\1\\3}</mrow>
            </md>.</p>
            <p>By <xref ref="theorem-SLSLC" acro="SLSLC"/>, we can summarize this solution as a linear combination of the columns of <m>A</m> that equals <m>\vect{b}</m>,<me>7\colvector{2\\-3\\1}+
            8\colvector{1\\4\\1}+
            1\colvector{7\\-5\\4}+
            3\colvector{-7\\-6\\-5}=
            \colvector{8\\-12\\4}=\vect{b}</me>.</p>
            <p>This equation says that <m>\vect{b}</m> is a linear combination of the columns of <m>A</m>, and then by <xref ref="definition-CSM" acro="CSM"/>, we can say that <m>\vect{b}\in\csp{A}</m>.</p>
            <p>On the other hand, Archetype<nbsp/><xref ref="archetype-E" acro="E" text="global"/> is the linear system <m>\linearsystem{A}{\vect{c}}</m>, where the vector of constants is<me>\vect{c}=\colvector{2\\3\\2}</me>and this system of equations is inconsistent.  This means <m>\vect{c}\not\in\csp{A}</m>, for if it were, then it would equal a linear combination of the columns of <m>A</m> and <xref ref="theorem-SLSLC" acro="SLSLC"/> would lead us to a solution of the system <m>\linearsystem{A}{\vect{c}}</m>.</p>
        </example>
        <p>So if we fix the coefficient matrix, and vary the vector of constants, we can sometimes find consistent systems, and sometimes inconsistent systems.  The vectors of constants that lead to consistent systems are exactly the elements of the column space.  This is the content of the next theorem, and since it is an equivalence, it provides an alternate view of the column space.</p>
        <theorem xml:id="theorem-CSCS" acro="CSCS">
            <title>Column Spaces and Consistent Systems</title>
            <idx>
                <h>column space</h>
                <h>consistent system</h>
            </idx>
            <statement>
                <p>Suppose <m>A</m> is an <m>m\times n</m> matrix and <m>\vect{b}</m> is a vector of size <m>m</m>.  Then <m>\vect{b}\in\csp{A}</m> if and only if <m>\linearsystem{A}{\vect{b}}</m> is consistent.</p>
            </statement>
            <proof>
                <case direction="forward">
                    <p>  Suppose <m>\vect{b}\in\csp{A}</m>.  Then we can write <m>\vect{b}</m> as some linear combination of the columns of <m>A</m>.  By <xref ref="theorem-SLSLC" acro="SLSLC"/> we can use the scalars from this linear combination to form a solution to  <m>\linearsystem{A}{\vect{b}}</m>, so this system is consistent.</p>
                </case>
                <case direction="backward">
                    <p> If <m>\linearsystem{A}{\vect{b}}</m> is consistent, there is a solution that may be used with <xref ref="theorem-SLSLC" acro="SLSLC"/> to write <m>\vect{b}</m> as a linear combination of the columns of <m>A</m>.  This qualifies <m>\vect{b}</m> for membership in <m>\csp{A}</m>.</p>
                </case>
            </proof>
        </theorem>
        <p>This theorem tells us that asking if the system <m>\linearsystem{A}{\vect{b}}</m> is consistent is exactly the same question as asking if <m>\vect{b}</m> is in the column space of <m>A</m>.  Or equivalently, it tells us that the column space of the matrix <m>A</m> is precisely those vectors of constants, <m>\vect{b}</m>, that can be paired with <m>A</m> to create a system of linear equations <m>\linearsystem{A}{\vect{b}}</m> that is consistent.</p>
        <p>Employing <xref ref="theorem-SLEMM" acro="SLEMM"/> we can form the chain of equivalences.<md>
            <mrow>\vect{b}\in\csp{A}
            \iff
            \linearsystem{A}{\vect{b}}\text{ is consistent}
            \iff
            A\vect{x}=\vect{b}\text{ for some }\vect{x}</mrow>
        </md></p>
        <p>Thus, an alternative (and popular) definition of the column space of an <m>m\times n</m> matrix <m>A</m> is<md>
            <mrow>\csp{A}&amp;=
            \setparts{
            \vect{y}\in\complex{m}
            }{
            \vect{y}=A\vect{x}\text{ for some }\vect{x}\in\complex{n}
            }
            =
            \setparts{A\vect{x}}{\vect{x}\in\complex{n}}
            \subseteq\complex{m}</mrow>
        </md>.</p>
        <p>We recognize this as saying create <em>all</em> the matrix vector products possible with the matrix <m>A</m> by letting <m>\vect{x}</m> range over all of the possibilities.  By <xref ref="definition-MVP" acro="MVP"/> we see that this means take all possible linear combinations of the columns of <m>A</m> <mdash/> precisely the definition of the column space (<xref ref="definition-CSM" acro="CSM"/>) we have chosen.</p>
        <p>Notice how this formulation of the column space looks very much like the definition of the null space of a matrix (<xref ref="definition-NSM" acro="NSM"/>), but for a rectangular matrix the column vectors of <m>\csp{A}</m> and <m>\nsp{A}</m> have different sizes, so the sets are very different.</p>
        <p>Given a vector <m>\vect{b}</m> and a matrix <m>A</m> it is now very mechanical to test if <m>\vect{b}\in\csp{A}</m>.  Form the linear system <m>\linearsystem{A}{\vect{b}}</m>, row-reduce the augmented matrix, <m>\augmented{A}{\vect{b}}</m>, and test for consistency with <xref ref="theorem-RCLS" acro="RCLS"/>.  Here is an example of this procedure.</p>
        <example xml:id="example-MCSM" acro="MCSM">
            <title>Membership in the column space of a matrix</title>
            <idx>
                <h>column space</h>
                <h>testing membership</h>
            </idx>
            <p>Consider the question of membership in the column space of the <m>3\times 4</m> matrix <m>A</m>, for the vector <m>\vect{v}</m>.  Is <m>\vect{v}\in\csp{A}</m>?<md>
                <mrow>A&amp;=
                \begin{bmatrix}
                3 &amp; 2 &amp; 1 &amp; -4\\
                -1 &amp; 1 &amp; -2 &amp; 3\\
                2 &amp; -4 &amp; 6 &amp; -8
                \end{bmatrix}
                &amp;
                \vect{v}&amp;=\colvector{18\\-6\\12}</mrow>
            </md></p>
            <p><xref ref="theorem-CSCS" acro="CSCS"/> says we need only check the consistency of <m>\linearsystem{A}{\vect{v}}</m>.  Form the augmented matrix and row-reduce,<me>\begin{bmatrix}
            3 &amp; 2 &amp; 1 &amp; -4 &amp; 18\\
            -1 &amp; 1 &amp; -2 &amp; 3 &amp; -6\\
            2 &amp; -4 &amp; 6 &amp; -8 &amp; 12
            \end{bmatrix}
            \rref
            \begin{bmatrix}
            \leading{1} &amp; 0 &amp; 1 &amp; -2 &amp; 6\\
            0 &amp; \leading{1} &amp; -1 &amp; 1 &amp; 0\\
            0 &amp; 0 &amp; 0 &amp; 0 &amp; 0
            \end{bmatrix}</me></p>
            <p>Since the final column is not a pivot column, <xref ref="theorem-RCLS" acro="RCLS"/> tells us the system is consistent and therefore by <xref ref="theorem-CSCS" acro="CSCS"/>, <m>\vect{v}\in\csp{A}</m>.</p>
            <p>If we wished to demonstrate explicitly that <m>\vect{v}</m> is a linear combination of the columns of <m>A</m>, we can find a solution (any solution) of <m>\linearsystem{A}{\vect{v}}</m> and use <xref ref="theorem-SLSLC" acro="SLSLC"/> to construct the desired linear combination.  For example, set the free variables to <m>x_3=2</m> and <m>x_4=1</m>.  Then a solution has <m>x_2=1</m> and <m>x_1=6</m>.  Then by <xref ref="theorem-SLSLC" acro="SLSLC"/><me>\vect{v}=\colvector{18\\-6\\12}=
            6\colvector{3\\-1\\2}+
            1\colvector{2\\1\\-4}+
            2\colvector{1\\-2\\6}+
            1\colvector{-4\\3\\-8}</me>.</p>
            <p>Now we show that the vector <m>\vect{w}</m> is <em>not</em> in the column space of <m>A</m>, <m>\vect{w}\not\in\csp{A}</m>.<me>\vect{w}=\colvector{2\\1\\-3}</me><xref ref="theorem-CSCS" acro="CSCS"/> says we need only check the consistency of <m>\linearsystem{A}{\vect{w}}</m>.  Form the augmented matrix and row-reduce<me>\begin{bmatrix}
            3 &amp; 2 &amp; 1 &amp; -4 &amp; 2\\
            -1 &amp; 1 &amp; -2 &amp; 3 &amp; 1\\
            2 &amp; -4 &amp; 6 &amp; -8 &amp; -3
            \end{bmatrix}
            \rref
            \begin{bmatrix}
            \leading{1} &amp; 0 &amp; 1 &amp; -2 &amp; 0\\
            0 &amp; \leading{1} &amp; -1 &amp; 1 &amp; 0\\
            0 &amp; 0 &amp; 0 &amp; 0 &amp; \leading{1}
            \end{bmatrix}</me>.</p>
            <p>since the final column is a pivot column, <xref ref="theorem-RCLS" acro="RCLS"/> tells us the system is inconsistent and therefore by <xref ref="theorem-CSCS" acro="CSCS"/>, <m>\vect{w}\not\in\csp{A}</m>.</p>
        </example>
        <computation xml:id="sage-CSCS" acro="CSCS">
            <title>Column Space and Consistent Systems</title>
            <idx>
                <h>column space</h>
                <h>consistent systems</h>
            </idx>
            <p>We could compute the column space of a matrix with a span of the set of columns of the matrix, much as we did back in Sage<nbsp/><xref ref="sage-CSS" acro="CSS" text="global"/> when we were checking consistency of linear systems using spans of the set of columns of a coefficent matrix.  However, Sage provides a convenient matrix method to construct this same span: <c>.column_space()</c>.  Here is a check.</p>
            <sage xml:id="sagecell-CSCS-1">
                <input>
                D = matrix(QQ, [[ 2, -1, -4],
                                [ 5,  2, -1],
                                [-3,  1,  5]])
                cs = D.column_space(); cs
                </input>
                <output>
                Vector space of degree 3 and dimension 2 over Rational Field
                Basis matrix:
                [    1     0 -11/9]
                [    0     1  -1/9]
                </output>
            </sage>
            <sage xml:id="sagecell-CSCS-2">
                <input>
                cs_span = (QQ^3).span(D.columns())
                cs == cs_span
                </input>
                <output>
                True
                </output>
            </sage>
            <p>In Sage<nbsp/><xref ref="sage-CSS" acro="CSS" text="global"/> we discussed solutions to systems of equations and the membership of the vector of constants in the span of the columns of the coefficient matrix.  This discussion turned on <xref ref="theorem-SLSLC" acro="SLSLC"/>.  We can now be slightly more efficient with <xref ref="theorem-CSCS" acro="CSCS"/>, while still using the same ideas.  We recycle the computations from <xref ref="example-CSMCS" acro="CSMCS"/> that use Archetype<nbsp/><xref ref="archetype-D" acro="D" text="global"/> and Archetype<nbsp/><xref ref="archetype-E" acro="E" text="global"/>.</p>
            <sage xml:id="sagecell-CSCS-3">
                <input>
                coeff = matrix(QQ, [[ 2, 1,  7, -7],
                                    [-3, 4, -5, -6],
                                    [ 1, 1,  4, -5]])
                constD = vector(QQ, [8, -12, 4])
                constE = vector(QQ, [2, 3, 2])
                cs = coeff.column_space()
                coeff.solve_right(constD)
                </input>
                <output>
                (4, 0, 0, 0)
                </output>
            </sage>
            <sage xml:id="sagecell-CSCS-4">
                <input>
                constD in cs
                </input>
                <output>
                True
                </output>
            </sage>
            <sage xml:id="sagecell-CSCS-5">
                <input>
                coeff.solve_right(constE)
                </input>
                <output>
                Traceback (most recent call last):
                ...
                ValueError: matrix equation has no solutions
                </output>
            </sage>
            <sage xml:id="sagecell-CSCS-6">
                <input>
                constE in cs
                </input>
                <output>
                False
                </output>
            </sage>
        </computation>
        <p><xref ref="theorem-CSCS" acro="CSCS"/> completes a collection of three theorems, and one definition, that deserve comment.  Many questions about spans, linear independence, null space, column spaces and similar objects can be converted to questions about systems of equations (homogeneous or not), which we understand well from our previous results, especially those in <xref ref="chapter-SLE" acro="SLE"/>.  These previous results include theorems like <xref ref="theorem-RCLS" acro="RCLS"/> which allows us to quickly decide consistency of a system, and <xref ref="theorem-BNS" acro="BNS"/> which allows us to describe solution sets for homogeneous systems compactly as the span of a linearly independent set of column vectors.</p>
        <p>The table below lists these four definitions and theorems along with a brief reminder of the statement and an example of how the statement is used.</p>
        <sidebyside>
            <tabular halign="left" top="medium">
                <row>
                    <cell colspan="2">
                        <xref ref="definition-NSM" acro="NSM"/>
                    </cell>
                </row>
                <row>
                    <cell>Synopsis</cell>
                    <cell>Null space is solution set of homogeneous system</cell>
                </row>
                <row bottom="medium">
                    <cell>Example</cell>
                    <cell>General solution sets described by Theorem PSPHS</cell>
                </row>
                <row>
                    <cell colspan="2">
                        <xref ref="theorem-SLSLC" acro="SLSLC"/>
                    </cell>
                </row>
                <row>
                    <cell>Synopsis</cell>
                    <cell>Solutions for linear combinations with unknown scalars</cell>
                </row>
                <row bottom="medium">
                    <cell>Example</cell>
                    <cell>Deciding membership in spans</cell>
                </row>
                <row>
                    <cell colspan="2">
                        <xref ref="theorem-SLEMM" acro="SLEMM"/>
                    </cell>
                </row>
                <row>
                    <cell>Synopsis</cell>
                    <cell>System of equations represented by matrix-vector product</cell>
                </row>
                <row bottom="medium">
                    <cell>Example</cell>
                    <cell>Solution to <m>\linearsystem{A}{\vect{b}}</m> is <m>\inverse{A}\vect{b}</m> when <m>A</m> is nonsingular</cell>
                </row>
                <row>
                    <cell colspan="2">
                        <xref ref="theorem-CSCS" acro="CSCS"/>
                    </cell>
                </row>
                <row>
                    <cell>Synopsis</cell>
                    <cell>Column space vectors create consistent systems</cell>
                </row>
                <row bottom="medium">
                    <cell>Example </cell>
                    <cell>Deciding membership in column spaces</cell>
                </row>
            </tabular>
        </sidebyside>
    </subsection>
    <subsection xml:id="subsection-CRS-CSSOC" acro="CSSOC">
        <title>Column Space Spanned by Original Columns</title>
        <p>So we have a foolproof, automated procedure for determining membership in <m>\csp{A}</m>.  While this works just fine a vector at a time, we would like to have a more useful description of the set <m>\csp{A}</m> as a whole.  The next example will preview the first of two fundamental results about the column space of a matrix.</p>
        <example xml:id="example-CSTW" acro="CSTW">
            <title>Column space, two ways</title>
            <idx>
                <h>column space</h>
                <h>two computations</h>
            </idx>
            <p>Consider the <m>5\times 7</m> matrix <m>A</m>.<me>\begin{bmatrix}
             2 &amp; 4 &amp; 1 &amp; -1 &amp; 1 &amp; 4 &amp; 4 \\
             1 &amp; 2 &amp; 1 &amp; 0 &amp; 2 &amp; 4 &amp; 7 \\
             0 &amp; 0 &amp; 1 &amp; 4 &amp; 1 &amp; 8 &amp; 7 \\
             1 &amp; 2 &amp; -1 &amp; 2 &amp; 1 &amp; 9 &amp; 6 \\
             -2 &amp; -4 &amp; 1 &amp; 3 &amp; -1 &amp; -2 &amp; -2
            \end{bmatrix}</me></p>
            <p>According to the definition (<xref ref="definition-CSM" acro="CSM"/>), the column space of <m>A</m> is<me>\csp{A}=
            \spn{\set{
            \colvector{ 2 \\ 1 \\ 0 \\ 1 \\ -2 },\,
            \colvector{ 4 \\ 2 \\ 0 \\ 2 \\ -4 },\,
            \colvector{ 1 \\ 1 \\ 1 \\ -1 \\ 1 },\,
            \colvector{ -1 \\ 0 \\ 4 \\ 2 \\ 3 },\,
            \colvector{ 1 \\ 2 \\ 1 \\ 1 \\ -1 },\,
            \colvector{ 4 \\ 4 \\ 8 \\ 9 \\ -2 },\,
            \colvector{ 4 \\ 7 \\ 7 \\ 6 \\ -2 }
            }}</me>.</p>
            <p>While this is a concise description of an infinite set, we might be able to describe the span with fewer than seven vectors.  This is the substance of <xref ref="theorem-BS" acro="BS"/>.  So we take these seven vectors and make them the columns of a matrix, which is simply the original matrix <m>A</m> again.  Now we row-reduce<me>\begin{bmatrix}
             2 &amp; 4 &amp; 1 &amp; -1 &amp; 1 &amp; 4 &amp; 4 \\
             1 &amp; 2 &amp; 1 &amp; 0 &amp; 2 &amp; 4 &amp; 7 \\
             0 &amp; 0 &amp; 1 &amp; 4 &amp; 1 &amp; 8 &amp; 7 \\
             1 &amp; 2 &amp; -1 &amp; 2 &amp; 1 &amp; 9 &amp; 6 \\
             -2 &amp; -4 &amp; 1 &amp; 3 &amp; -1 &amp; -2 &amp; -2
            \end{bmatrix}
            \rref
            \begin{bmatrix}
             \leading{1} &amp; 2 &amp; 0 &amp; 0 &amp; 0 &amp; 3 &amp; 1 \\
             0 &amp; 0 &amp; \leading{1} &amp; 0 &amp; 0 &amp; -1 &amp; 0 \\
             0 &amp; 0 &amp; 0 &amp; \leading{1} &amp; 0 &amp; 2 &amp; 1 \\
             0 &amp; 0 &amp; 0 &amp; 0 &amp; \leading{1} &amp; 1 &amp; 3 \\
             0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0
            \end{bmatrix}</me>.</p>
            <p>The pivot columns are <m>D=\set{1,\,3,\,4,\,5}</m>, so we can create the set<me>T=\set{
            \colvector{ 2 \\ 1 \\ 0 \\ 1 \\ -2 },\,
            \colvector{ 1 \\ 1 \\ 1 \\ -1 \\ 1 },\,
            \colvector{ -1 \\ 0 \\ 4 \\ 2 \\ 3 },\,
            \colvector{ 1 \\ 2 \\ 1 \\ 1 \\ -1 }
            }</me>and know that <m>\csp{A}=\spn{T}</m> and <m>T</m> is a linearly independent set of columns from the set of columns of <m>A</m>.</p>
        </example>
        <p>We will now formalize the previous example, which will make it trivial to determine a linearly independent set of vectors that will span the column space of a matrix, and is constituted of just columns of <m>A</m>.</p>
        <theorem xml:id="theorem-BCS" acro="BCS">
            <title>Basis of the Column Space</title>
            <idx>
                <h>column space</h>
                <h>basis</h>
            </idx>
            <statement>
                <p>Suppose that <m>A</m> is an <m>m\times n</m> matrix with columns <m>\vectorlist{A}{n}</m>, and <m>B</m> is a row-equivalent matrix in reduced row-echelon form with <m>r</m> pivot columns.  Let <m>D=\{d_1,\,d_2,\,d_3,\,\ldots,\,d_r\}</m> be the set of indices for the pivot columns of <m>B</m>  Let <m>T=\set{\vect{A}_{d_1},\,\vect{A}_{d_2},\,\vect{A}_{d_3},\,\ldots,\,\vect{A}_{d_r}}</m>.  Then<ol>
                    <li><m>T</m> is a linearly independent set.</li>
                    <li><m>\csp{A}=\spn{T}</m>.</li></ol></p>
            </statement>
            <proof>
                <p><xref ref="definition-CSM" acro="CSM"/> describes the column space as the span of the set of columns of <m>A</m>.  <xref ref="theorem-BS" acro="BS"/> tells us that we can reduce the set of vectors used in a span.  If we apply <xref ref="theorem-BS" acro="BS"/> to <m>\csp{A}</m>, we would collect the columns of <m>A</m> into a matrix (which would just be <m>A</m> again) and bring the matrix to reduced row-echelon form, which is the matrix <m>B</m> in the statement of the theorem.  In this case, the conclusions of <xref ref="theorem-BS" acro="BS"/> applied to <m>A</m>,  <m>B</m> and <m>\csp{A}</m> are exactly the conclusions we desire.</p>
            </proof>
        </theorem>
        <p>This is a nice result since it gives us a handful of vectors that describe the entire column space (through the span), and we believe this set is as small as possible because we cannot create any more relations of linear dependence to trim it down further.  Furthermore, we defined the column space (<xref ref="definition-CSM" acro="CSM"/>) as all linear combinations of the columns of the matrix, and the elements of the set <m>T</m> are still columns of the matrix (we will not be so lucky in the next two constructions of the column space).</p>
        <p>Procedurally this theorem is extremely easy to apply.  Row-reduce the original matrix, identify the <m>r</m> pivot columns of the row-reduced matrix, and grab the columns of the original matrix with the same indices as the pivot columns.  But it is still important to study the proof of <xref ref="theorem-BS" acro="BS"/> and its motivation in <xref ref="example-COV" acro="COV"/> which lie at the root of this theorem.  We will trot through an example all the same.</p>
        <example xml:id="example-CSOCD" acro="CSOCD">
            <title>Column space, original columns, Archetype D</title>
            <idx>
                <h>column space</h>
                <h>original columns,  Archetype D</h>
            </idx>
            <idx>
                <h>Archetype D</h>
                <h>column space, original columns</h>
            </idx>
            <!-- Archetype D, Part purematrix -->
            <!-- Archetype D, Part matrixreduced -->
            <p>Let us determine a compact expression for the entire column space of the coefficient matrix of the system of equations that is Archetype<nbsp/><xref ref="archetype-D" acro="D" text="global"/>.  Notice that in <xref ref="example-CSMCS" acro="CSMCS"/> we were only determining if individual vectors were in the column space or not, now we are describing the entire column space.</p>
            <p>To start with the application of <xref ref="theorem-BCS" acro="BCS"/>, call the coefficient matrix <m>A</m> and row-reduce it to reduced row-echelon form <m>B</m><md>
                <mrow>A&amp;=\begin{bmatrix}
                2 &amp; 1 &amp; 7 &amp; -7\\
                -3 &amp; 4 &amp;  -5 &amp; -6\\
                1 &amp; 1 &amp; 4 &amp;  -5
                \end{bmatrix}
                &amp;B&amp;=\begin{bmatrix}
                \leading{1} &amp; 0 &amp; 3 &amp; -2\\
                0 &amp; \leading{1} &amp; 1 &amp;  -3\\
                0 &amp; 0 &amp; 0 &amp;  0
                \end{bmatrix}</mrow>
                </md>.</p>
            <p>Since columns 1 and 2 are pivot columns, <m>D=\{1,\,2\}</m>.  To construct a set that spans <m>\csp{A}</m>, just grab the columns of <m>A</m> with indices in <m>D</m>, so<me>\csp{A}=\spn{\set{\colvector{2\\-3\\1},\,\colvector{1\\4\\1}}}</me>.That's it.</p>
            <p>In <xref ref="example-CSMCS" acro="CSMCS"/> we determined that the vector<me>\vect{c}=\colvector{2\\3\\2}</me><em>was not</em> in the column space of <m>A</m>.  Try to write <m>\vect{c}</m> as a linear combination of the first two columns of <m>A</m>.  What happens?</p>
            <p>Also in <xref ref="example-CSMCS" acro="CSMCS"/> we determined that the vector<me>\vect{b}=\colvector{8\\-12\\4}</me><em>was</em> in the column space of <m>A</m>.  Try to write <m>\vect{b}</m> as a linear combination of the first two columns of <m>A</m>.  What happens?  Did you find a unique solution to this question?  Hmmmm.</p>
        </example>
        <computation xml:id="sage-CSOC" acro="CSOC">
            <title>Column Space, Original Columns</title>
            <idx>
                <h>column space</h>
                <h>original columns</h>
            </idx>
            <p>It might be worthwhile for Sage to create a column space using actual columns of the matrix as a spanning set.  But we can do it ourselves fairly easily.  A discussion follows the example.</p>
            <sage xml:id="sagecell-CSOC-1">
                <input>
                A = matrix(QQ, [[-1, -1, 0,  1,  0,  1, -2, -3, 0],
                                [-1,  0, 0,  5, -2,  6, -6,  3, 5],
                                [ 0,  0, 1, -6, -1,  0, -5,  0, 5],
                                [ 2,  2, 1, -8, -2,  0, -4,  8, 8],
                                [ 2,  2, 0, -2, -1,  0,  1,  8, 3],
                                [ 2,  1, 0, -6, -1, -1, -1,  6, 4]])
                A.rref()
                </input>
                <output>
                [ 1  0  0 -5  0 -2  0  1  1]
                [ 0  1  0  4  0  1  2  2 -1]
                [ 0  0  1 -6  0 -2 -2 -2  2]
                [ 0  0  0  0  1 -2  3 -2 -3]
                [ 0  0  0  0  0  0  0  0  0]
                [ 0  0  0  0  0  0  0  0  0]
                </output>
            </sage>
            <sage xml:id="sagecell-CSOC-2">
                <input>
                B = A.matrix_from_columns(A.pivots())
                A.column_space() == B.column_space()
                </input>
                <output>
                True
                </output>
            </sage>
            <sage xml:id="sagecell-CSOC-3">
                <input>
                B.rref()
                </input>
                <output>
                [1 0 0 0]
                [0 1 0 0]
                [0 0 1 0]
                [0 0 0 1]
                [0 0 0 0]
                [0 0 0 0]
                </output>
            </sage>
            <sage xml:id="sagecell-CSOC-4">
                <input>
                cs = (QQ^6).span_of_basis(B.columns())
                cs
                </input>
                <output>
                Vector space of degree 6 and dimension 4 over Rational Field
                User basis matrix:
                [-1 -1  0  2  2  2]
                [-1  0  0  2  2  1]
                [ 0  0  1  1  0  0]
                [ 0 -2 -1 -2 -1 -1]
                </output>
            </sage>
            <sage xml:id="sagecell-CSOC-5">
                <input>
                cs.basis()
                </input>
                <output>
                [
                (-1, -1, 0, 2, 2, 2),
                (-1, 0, 0, 2, 2, 1),
                (0, 0, 1, 1, 0, 0),
                (0, -2, -1, -2, -1, -1)
                ]
                </output>
            </sage>
            <sage xml:id="sagecell-CSOC-6">
                <input>
                cs.echelonized_basis()
                </input>
                <output>
                [
                (1, 0, 0, 0, 0, 5),
                (0, 1, 0, 0, 0, -1),
                (0, 0, 1, 0, -1, -3),
                (0, 0, 0, 1, 1, 3)
                ]
                </output>
            </sage>
            <sage xml:id="sagecell-CSOC-7">
                <input>
                cs == A.column_space()
                </input>
                <output>
                True
                </output>
            </sage>
            <sage xml:id="sagecell-CSOC-8">
                <input>
                cs2 = (QQ^6).span_of_basis([A.column(i) for i in A.pivots()])
                cs2 == A.column_space()
                </input>
                <output>
                True
                </output>
            </sage>
            <p>We see that <c>A</c> has four pivot columns, numbered <c>0,1,2,4</c>.  The matrix <c>B</c> is just a convenience to hold the pivot columns of <c>A</c>.  However, the column spaces of <c>A</c> and <c>B</c> should be equal, as Sage verifies.  Also <c>B</c> will row-reduce to the same 0-1 pivot columns of the reduced row-echelon form of the full matrix <c>A</c>.  So it is no accident that the reduced row-echelon form of <c>B</c> is a full identity matrix, followed by sufficiently many zero rows to give the matrix the correct size.</p>
            <p>The vector space method <c>.span_of_basis()</c> is new to us.  It creates a span of a set of vectors, as before, but we now are responsible for supplying a linearly independent set of vectors.  Which we have done.  We know this because <xref ref="theorem-BCS" acro="BCS"/> guarantees the set we provided is linearly independent (and spans the column space), while Sage would have given us an error if we had provided a linearly dependent set.  In return, Sage will carry this linearly independent spanning set along with the vector space, something Sage calls a <q>user basis.</q></p>
            <p>Notice how <c>cs</c> has two linearly independent spanning sets now.  Our set of <q>original columns</q> is obtained via the standard vector space method <c>.basis()</c> and we can obtain a linearly independent spanning set that looks more familiar with the vector space method <c>.echelonized_basis()</c>.  For a vector space created with a simple <c>.span()</c> construction these two commands would yield identical results <mdash/> it is only when we supply a linearly independent spanning set with the <c>.span_of_basis()</c> method that a <q>user basis</q> becomes relevant.</p>
            <p>Finally, we check that <c>cs</c> is indeed the column space of <c>A</c> (we knew it would be) and then we provide a one-line, totally general construction of the column space using original columns.</p>
            <p>This is an opportunity to make an interesting observation, which could be used to substantiate several theorems.  When we take the original columns that we recognize as pivot columns, and use them alone to form a matrix, this new matrix <em>will always</em> row-reduce to an identity matrix followed by zero rows.  This is basically a consequence of reduced row-echelon form.  Evaluate the compute cell below repeatedly.  The number of columns could in theory change, though this is unlikely since the columns of a random matrix are unlikely to be linearly dependent.  In any event, the form of the result will always be an identity matrix followed by some zero rows.</p>
            <sage xml:id="sagecell-CSOC-9">
                <input>
                F = random_matrix(QQ, 5, 3)
                F.matrix_from_columns(F.pivots()).rref()   # random
                </input>
                <output>
                [1 0 0]
                [0 1 0]
                [0 0 1]
                [0 0 0]
                [0 0 0]
                </output>
            </sage>
            <p>With more columns than rows, we know by <xref ref="theorem-MVSLD" acro="MVSLD"/> that we will have a reduced number of pivot columns.  Here, we will almost always see an identity matrix as the result, though we could get a smaller identity matrix followed by zero rows.</p>
            <sage xml:id="sagecell-CSOC-10">
                <input>
                F = random_matrix(QQ, 3, 5)
                F.matrix_from_columns(F.pivots()).rref()   # random
                </input>
                <output>
                [1 0 0]
                [0 1 0]
                [0 0 1]
                </output>
            </sage>
        </computation>
    </subsection>
    <subsection xml:id="subsection-CRS-CSNM" acro="CSNM">
        <title>Column Space of a Nonsingular Matrix</title>
        <p>Let us specialize to square matrices and contrast the column spaces of the coefficient matrices in Archetype<nbsp/><xref ref="archetype-A" acro="A" text="global"/> and Archetype<nbsp/><xref ref="archetype-B" acro="B" text="global"/>.</p>
        <example xml:id="example-CSAA" acro="CSAA">
            <title>Column space of Archetype A</title>
            <idx>
                <h>column space</h>
                <h>Archetype A</h>
            </idx>
            <idx>
                <h>Archetype A</h>
                <h>column space</h>
            </idx>
            <!-- Archetype A, Part purematrix -->
            <!-- Archetype A, Part matrixreduced -->
            <p>The coefficient matrix in Archetype<nbsp/><xref ref="archetype-A" acro="A" text="global"/> is <m>A</m>, which row-reduces to <m>B</m>.<md>
            <mrow>A&amp;=\begin{bmatrix}
            1 &amp; -1 &amp; 2\\
            2 &amp; 1 &amp; 1\\
            1 &amp; 1 &amp; 0
            \end{bmatrix}
            &amp;B&amp;=\begin{bmatrix}
            \leading{1} &amp; 0 &amp; 1\\
            0 &amp; \leading{1} &amp; -1\\
            0 &amp; 0 &amp; 0
            \end{bmatrix}</mrow>
            </md></p>
            <p>Columns 1 and 2 are pivot columns, so by <xref ref="theorem-BCS" acro="BCS"/> we can write<me>\csp{A}=\spn{\set{\vect{A}_1,\,\vect{A}_2}}=\spn{\set{\colvector{1\\2\\1},\,\colvector{-1\\1\\1}}}</me>.</p>
            <p>We want to show in this example that <m>\csp{A}\neq\complex{3}</m>.  So take, for example, the vector <m>\vect{b}</m>.<me>\vect{b}=\colvector{1\\3\\2}</me>Then there is no solution to the system <m>\linearsystem{A}{\vect{b}}</m>, or equivalently, it is not possible to write <m>\vect{b}</m> as a linear combination of <m>\vect{A}_1</m> and <m>\vect{A}_2</m>.  Try  one of these two computations yourself.  (Or try both!).  Since <m>\vect{b}\not\in\csp{A}</m>, the column space of <m>A</m> cannot be all of <m>\complex{3}</m>.  So by varying the vector of constants, it is possible to create inconsistent systems of equations with this coefficient matrix (the vector <m>\vect{b}</m> being one such example).</p>
            <p>In <xref ref="example-MWIAA" acro="MWIAA"/> we wished to show that the coefficient matrix from Archetype<nbsp/><xref ref="archetype-A" acro="A" text="global"/> was not invertible as a first example of a matrix without an inverse.  Our device there was to find an inconsistent linear system with <m>A</m> as the coefficient matrix.  The vector of constants in that example was <m>\vect{b}</m>, deliberately chosen outside the column space of <m>A</m>.</p>
        </example>
        <example xml:id="example-CSAB" acro="CSAB">
            <title>Column space of Archetype B</title>
            <idx>
                <h>column space</h>
                <h>Archetype B</h>
            </idx>
            <idx>
                <h>Archetype B</h>
                <h>column space</h>
            </idx>
            <p>The coefficient matrix in Archetype<nbsp/><xref ref="archetype-B" acro="B" text="global"/>, call it <m>B</m> here,  is known to be nonsingular (see <xref ref="example-NM" acro="NM"/>).  By <xref ref="theorem-NMUS" acro="NMUS"/>, the linear system <m>\linearsystem{B}{\vect{b}}</m> has a (unique) solution for every choice of <m>\vect{b}</m>.  <xref ref="theorem-CSCS" acro="CSCS"/> then says that <m>\vect{b}\in\csp{B}</m> for all <m>\vect{b}\in\complex{3}</m>.  Stated differently, there is no way to build an inconsistent system with the coefficient matrix <m>B</m>, but then we knew that already from <xref ref="theorem-NMUS" acro="NMUS"/>.</p>
        </example>
        <p><xref ref="example-CSAA" acro="CSAA"/> and <xref ref="example-CSAB" acro="CSAB"/> together motivate the following equivalence, which says that nonsingular matrices have column spaces that are as big as possible.</p>
        <theorem xml:id="theorem-CSNM" acro="CSNM">
            <title>Column Space of a Nonsingular Matrix</title>
            <idx>
                <h>column space</h>
                <h>nonsingular matrix</h>
            </idx>
            <statement>
                <idx>
                    <h>nonsingular matrix</h>
                    <h>column space</h>
                </idx>
                <p>Suppose <m>A</m> is a square matrix of size <m>n</m>.  Then <m>A</m> is nonsingular if and only if <m>\csp{A}=\complex{n}</m>.</p>
            </statement>
            <proof>
                <case direction="forward">
                    <p>Suppose <m>A</m> is nonsingular.  We wish to establish the set equality <m>\csp{A}=\complex{n}</m>.  By <xref ref="definition-CSM" acro="CSM"/>, <m>\csp{A}\subseteq\complex{n}</m>.  To show that  <m>\complex{n}\subseteq\csp{A}</m> choose <m>\vect{b}\in\complex{n}</m>.  By <xref ref="theorem-NMUS" acro="NMUS"/>, we know the linear system <m>\linearsystem{A}{\vect{b}}</m> has a (unique) solution and therefore is consistent.  <xref ref="theorem-CSCS" acro="CSCS"/> then says that <m>\vect{b}\in\csp{A}</m>.  So  by <xref ref="definition-SE" acro="SE"/>, <m>\csp{A}=\complex{n}</m>.</p>
                </case>
                <case direction="backward">
                    <p>If <m>\vect{e}_i</m> is column <m>i</m> of the <m>n\times n</m> identity matrix (<xref ref="definition-SUV" acro="SUV"/>) and by hypothesis <m>\csp{A}=\complex{n}</m>, then <m>\vect{e}_i\in\csp{A}</m> for <m>1\leq i\leq n</m>.  By <xref ref="theorem-CSCS" acro="CSCS"/>, the system <m>\linearsystem{A}{\vect{e}_i}</m> is consistent for <m>1\leq i\leq n</m>.   Let <m>\vect{b}_i</m> denote any one particular solution to <m>\linearsystem{A}{\vect{e}_i}</m>, <m>1\leq i\leq n</m>.</p>
                    <p>Define the <m>n\times n</m> matrix <m>B=\matrixcolumns{b}{n}</m>.  Then<md>
                        <mrow>AB
                        &amp;=A\matrixcolumns{b}{n}</mrow>
                        <mrow>&amp;=[A\vect{b}_1|A\vect{b}_2|A\vect{b}_3|\ldots|A\vect{b}_n]&amp;&amp;
                            <xref ref="definition-MM" acro="MM"/></mrow>
                        <mrow>&amp;=\matrixcolumns{e}{n}</mrow>
                        <mrow>&amp;=I_n&amp;&amp;
                            <xref ref="definition-SUV" acro="SUV"/></mrow>
                    </md></p>
                    <p>So the matrix <m>B</m> is a <q>right-inverse</q> for <m>A</m>.  By <xref ref="theorem-NMRRI" acro="NMRRI"/>, <m>I_n</m> is a nonsingular matrix, so by <xref ref="theorem-NPNT" acro="NPNT"/> both <m>A</m> and <m>B</m> are nonsingular.  Thus, in particular, <m>A</m> is nonsingular.  (<xref ref="travisosborne"/> contributed to this proof.)</p>
                </case>
            </proof>
        </theorem>
        <p>With this equivalence for nonsingular matrices we can update our list, <xref ref="theorem-NME3" acro="NME3"/>.</p>
        <theorem xml:id="theorem-NME4" acro="NME4">
            <title>Nonsingular Matrix Equivalences, Round 4</title>
            <idx>
                <h>nonsingular matrix</h>
                <h>equivalences</h>
            </idx>
            <statement>
                <p>Suppose that <m>A</m> is a square matrix of size <m>n</m>.  The following are equivalent.<ol>
                    <li><m>A</m> is nonsingular.</li>
                    <li><m>A</m> row-reduces to the identity matrix.</li>
                    <li> The null space of <m>A</m> contains only the zero vector, <m>\nsp{A}=\set{\zerovector}</m>. </li>
                    <li> The linear system <m>\linearsystem{A}{\vect{b}}</m> has a unique solution for every possible choice of <m>\vect{b}</m>.</li>
                    <li> The columns of <m>A</m> are a linearly independent set.</li>
                    <li><m>A</m> is invertible.</li>
                    <li> The column space of <m>A</m> is <m>\complex{n}</m>, <m>\csp{A}=\complex{n}</m>.</li>
                </ol></p>
            </statement>
            <proof>
                <p>Since <xref ref="theorem-CSNM" acro="CSNM"/> is an equivalence, we can add it to the list in <xref ref="theorem-NME3" acro="NME3"/>.</p>
            </proof>
        </theorem>
        <computation xml:id="sage-NME4" acro="NME4">
            <title>Nonsingular Matrix Equivalences, Round 4</title>
            <idx>
                <h>nonsingular matrices</h>
                <h>round 4</h>
            </idx>
            <p>Archetype<nbsp/><xref ref="archetype-A" acro="A" text="global"/> and Archetype<nbsp/><xref ref="archetype-B" acro="B" text="global"/> have square coefficient matrices that illustrate the dichotomy of singular and nonsingular matrices.  Here we illustrate the latest addition to our series of equivalences, <xref ref="theorem-CSNM" acro="CSNM"/>.</p>
            <sage xml:id="sagecell-NME4-1">
                <input>
                A = matrix(QQ, [[1, -1, 2],
                                [2,  1, 1],
                                [1,  1, 0]])
                B = matrix(QQ, [[-7, -6, -12],
                                [ 5,  5,   7],
                                [ 1,  0,   4]])
                A.is_singular()
                </input>
                <output>
                True
                </output>
            </sage>
            <sage xml:id="sagecell-NME4-2">
                <input>
                A.column_space() == QQ^3
                </input>
                <output>
                False
                </output>
            </sage>
            <sage xml:id="sagecell-NME4-3">
                <input>
                B.is_singular()
                </input>
                <output>
                False
                </output>
            </sage>
            <sage xml:id="sagecell-NME4-4">
                <input>
                B.column_space() == QQ^3
                </input>
                <output>
                True
                </output>
            </sage>
            <p>We can even write <xref ref="theorem-CSNM" acro="CSNM"/> as a one-line Sage statement that will return <c>True</c> for <em>any</em> square matrix.  Run the following repeatedly and it should always return <c>True</c>.  We have kept the size of the matrix relatively small to be sure that some of the random matrices produced are singular.</p>
            <sage xml:id="sagecell-NME4-5">
                <input>
                A = random_matrix(QQ, 4, 4)
                A.is_singular() == (not A.column_space() == QQ^4)
                </input>
                <output>
                True
                </output>
            </sage>
        </computation>
    </subsection>
    <subsection xml:id="subsection-CRS-RSM" acro="RSM">
        <title>Row Space of a Matrix</title>
        <p>The rows of a matrix can be viewed as vectors, since they are just lists of numbers, arranged horizontally.  So we will transpose a matrix, turning rows into columns, so we can then manipulate rows as column vectors.  As a result we will be able to make some new connections between row operations and solutions to systems of equations.  OK, here is the second primary definition of this section.</p>
        <definition xml:id="definition-RSM" acro="RSM">
            <title>Row Space of a Matrix</title>
            <idx>
                <h>matrix</h>
                <h>row space</h>
            </idx>
            <statement>
                <p>Suppose <m>A</m> is an <m>m\times n</m> matrix.  Then the <term>row space</term> of <m>A</m>, <m>\rsp{A}</m>, is the column space of <m>\transpose{A}</m>, <ie/> <m>\rsp{A}=\csp{\transpose{A}}</m>.</p>
            </statement>
            <notation xml:id="notation-RSM" acro="RSM">
                <idx>
                    <h>row space</h>
                    <h>notation</h>
                </idx>
                <description>Row Space of a Matrix</description>
                <usage>\rsp{A}</usage>
            </notation>
        </definition>
        <p>Informally, the row space is the set of all linear combinations of the rows of <m>A</m>.  However, we write the rows as column vectors, thus the necessity of using the transpose to make the rows into columns.   Additionally, with the row space defined in terms of the column space, all of the previous results of this section can be applied to row spaces.</p>
        <p>Notice that if <m>A</m> is a rectangular <m>m\times n</m> matrix, then <m>\csp{A}\subseteq\complex{m}</m>, while <m>\rsp{A}\subseteq\complex{n}</m> and the two sets are not comparable since they do not even hold objects of the same type.  However, when <m>A</m> is square of size <m>n</m>, both <m>\csp{A}</m> and <m>\rsp{A}</m> are subsets of <m>\complex{n}</m>, though usually the sets will not be equal (but see <xref ref="exercise-CRS-M20" acro="CRS.M20"/>).</p>
        <example xml:id="example-RSAI" acro="RSAI">
            <title>Row space of Archetype I</title>
            <idx>
                <h>row space</h>
                <h>Archetype I</h>
            </idx>
            <idx>
                <h>Archetype I</h>
                <h>row space</h>
            </idx>
            <!-- Archetype I, Part purematrix -->
            <p>The coefficient matrix in Archetype<nbsp/><xref ref="archetype-I" acro="I" text="global"/> is<me>I=\begin{bmatrix}
             1 &amp; 4 &amp; 0 &amp; -1 &amp; 0 &amp; 7 &amp;  -9 \\
             2 &amp; 8 &amp;  -1 &amp; 3 &amp; 9 &amp;  -13 &amp; 7\\
             0 &amp; 0 &amp;  2 &amp; -3 &amp; -4 &amp; 12 &amp;  -8\\
             -1 &amp;  -4 &amp; 2 &amp; 4 &amp; 8 &amp;  -31 &amp; 37
            \end{bmatrix}
            </me>.</p>
            <p>To build the row space, we transpose the matrix.<me>\transpose{I}=
            \begin{bmatrix}
            1 &amp; 2 &amp; 0 &amp; -1\\
            4 &amp; 8 &amp; 0 &amp; -4\\
            0 &amp; -1 &amp; 2 &amp; 2\\
            -1 &amp; 3 &amp; -3 &amp; 4\\
            0 &amp; 9 &amp; -4 &amp; 8\\
            7 &amp; -13 &amp; 12 &amp; -31\\
            -9 &amp; 7 &amp; -8 &amp; 37
            \end{bmatrix}</me></p>
            <p>Then the columns of this matrix are used in a span to build the row space.<me>\rsp{I}=\csp{\transpose{I}}=
            \spn{\set{
            \colvector{1\\4\\0\\-1\\0\\7\\-9},\,
            \colvector{2\\8\\-1\\3\\9\\-13\\7},\,
            \colvector{0\\0\\2\\-3\\-4\\12\\-8},\,
            \colvector{-1\\-4\\2\\4\\8\\-31\\37}
            }}</me></p>
            <p>However, we can use <xref ref="theorem-BCS" acro="BCS"/> to get a slightly better description.  First, row-reduce <m>\transpose{I}</m>.<me>\begin{bmatrix}
            \leading{1} &amp; 0 &amp; 0 &amp; -\frac{31}{7}\\
            0 &amp; \leading{1} &amp; 0 &amp; \frac{12}{7}\\
            0 &amp; 0 &amp; \leading{1} &amp; \frac{13}{7}\\
            0 &amp; 0 &amp; 0 &amp; 0\\
            0 &amp; 0 &amp; 0 &amp; 0\\
            0 &amp; 0 &amp; 0 &amp; 0\\
            0 &amp; 0 &amp; 0 &amp; 0
            \end{bmatrix}</me></p>
            <p>Since the pivot columns have indices <m>D=\set{1,\,2,\,3}</m>, the column space of <m>\transpose{I}</m> can be spanned by just the first three columns of <m>\transpose{I}</m>.<me>\rsp{I}=\csp{\transpose{I}}=
            \spn{\set{
            \colvector{1\\4\\0\\-1\\0\\7\\-9},\,
            \colvector{2\\8\\-1\\3\\9\\-13\\7},\,
            \colvector{0\\0\\2\\-3\\-4\\12\\-8}
            }}</me></p>
        </example>
        <p>The row space would not be too interesting if it was simply the column space of the transpose.  However, when we do row operations on a matrix we have no effect on the many linear combinations that can be formed with the rows of the matrix.  This is stated more carefully in the following theorem.</p>
        <theorem xml:id="theorem-REMRS" acro="REMRS">
            <title>Row-Equivalent Matrices have equal Row Spaces</title>
            <idx>
                <h>row space</h>
                <h>row-equivalent matrices</h>
            </idx>
            <statement>
                <idx>
                    <h>row-equivalent matrices</h>
                    <h>row space</h>
                </idx>
                <p>Suppose <m>A</m> and <m>B</m> are row-equivalent matrices.  Then <m>\rsp{A}=\rsp{B}</m>.</p>
            </statement>
            <proof>
                <p>Two matrices are row-equivalent (<xref ref="definition-REM" acro="REM"/>) if one can be obtained from another by a sequence of (possibly many) row operations.  We will prove the theorem for two matrices that differ by a single row operation, and then this result can be applied repeatedly to get the full statement of the theorem.  The row spaces of <m>A</m> and <m>B</m> are spans of the columns of their transposes.  For each row operation we perform on a matrix, we can define an analogous operation on the columns.  Perhaps we should call these <term>column operations</term>.  Instead, we will still call them row operations, but we will apply them to the columns of the transposes.</p>
                <p>Refer to the columns of <m>\transpose{A}</m> and <m>\transpose{B}</m> as <m>\vect{A}_i</m> and <m>\vect{B}_i</m>, <m>1\leq i\leq m</m>.  The row operation that switches rows will just switch columns of the transposed matrices.  This will have no effect on the possible linear combinations formed by the columns.</p>
                <p>Suppose that <m>\transpose{B}</m> is formed from <m>\transpose{A}</m> by multiplying column <m>\vect{A}_t</m> by <m>\alpha\neq 0</m>.  In other words, <m>\vect{B}_t=\alpha\vect{A}_t</m>, and <m>\vect{B}_i=\vect{A}_i</m> for all <m>i\neq t</m>.  We need to establish that two sets are equal, <m>\csp{\transpose{A}}=\csp{\transpose{B}}</m>.  We will take a generic element of one and show that it is contained in the other.<md>
                    <mrow>\beta_1\vect{B}_1+
                    &amp;
                    \beta_2\vect{B}_2+
                    \beta_3\vect{B}_3+
                    \cdots+
                    \beta_t\vect{B}_t+
                    \cdots+
                    \beta_m\vect{B}_m</mrow>
                    <mrow>&amp;=
                    \beta_1\vect{A}_1+
                    \beta_2\vect{A}_2+
                    \beta_3\vect{A}_3+
                    \cdots+
                    \beta_t\left(\alpha\vect{A}_t\right)+
                    \cdots+
                    \beta_m\vect{A}_m</mrow>
                    <mrow>&amp;=
                    \beta_1\vect{A}_1+
                    \beta_2\vect{A}_2+
                    \beta_3\vect{A}_3+
                    \cdots+
                    \left(\alpha\beta_t\right)\vect{A}_t+
                    \cdots+
                    \beta_m\vect{A}_m</mrow>
                    </md>says that <m>\csp{\transpose{B}}\subseteq\csp{\transpose{A}}</m>.  Similarly,<md>
                    <mrow>\gamma_1\vect{A}_1+
                    &amp;
                    \gamma_2\vect{A}_2+
                    \gamma_3\vect{A}_3+
                    \cdots+
                    \gamma_t\vect{A}_t+
                    \cdots+
                    \gamma_m\vect{A}_m</mrow>
                    <mrow>&amp;=
                    \gamma_1\vect{A}_1+
                    \gamma_2\vect{A}_2+
                    \gamma_3\vect{A}_3+
                    \cdots+
                    \left(\frac{\gamma_t}{\alpha}\alpha\right)\vect{A}_t+
                    \cdots+
                    \gamma_m\vect{A}_m</mrow>
                    <mrow>&amp;=
                    \gamma_1\vect{A}_1+
                    \gamma_2\vect{A}_2+
                    \gamma_3\vect{A}_3+
                    \cdots+
                    \frac{\gamma_t}{\alpha}\left(\alpha\vect{A}_t\right)+
                    \cdots+
                    \gamma_m\vect{A}_m</mrow>
                    <mrow>&amp;=
                    \gamma_1\vect{B}_1+
                    \gamma_2\vect{B}_2+
                    \gamma_3\vect{B}_3+
                    \cdots+
                    \frac{\gamma_t}{\alpha}\vect{B}_t+
                    \cdots+
                    \gamma_m\vect{B}_m</mrow>
                </md>says that <m>\csp{\transpose{A}}\subseteq\csp{\transpose{B}}</m>.   So <m>\rsp{A}=\csp{\transpose{A}}=\csp{\transpose{B}}=\rsp{B}</m> when a single row operation of the second type is performed.</p>
                <p>Suppose now that <m>\transpose{B}</m> is formed from <m>\transpose{A}</m> by replacing <m>\vect{A}_t</m> with <m>\alpha\vect{A}_s+\vect{A}_t</m> for some <m>\alpha\in\complexes</m> and <m>s\neq t</m>.  In other words, <m>\vect{B}_t=\alpha\vect{A}_s+\vect{A}_t</m>, and <m>\vect{B}_i=\vect{A}_i</m> for <m>i\neq t</m>.<md>
                    <mrow>\beta_1\vect{B}_1+
                    &amp;
                    \beta_2\vect{B}_2+
                    \cdots+
                    \beta_s\vect{B}_s+
                    \cdots+
                    \beta_t\vect{B}_t+
                    \cdots+
                    \beta_m\vect{B}_m</mrow>
                    <mrow>&amp;=
                    \beta_1\vect{A}_1+
                    \beta_2\vect{A}_2+
                    \cdots+
                    \beta_s\vect{A}_s+
                    \cdots+
                    \beta_t\left(\alpha\vect{A}_s+\vect{A}_t\right)+
                    \cdots+
                    \beta_m\vect{A}_m</mrow>
                    <mrow>&amp;=
                    \beta_1\vect{A}_1+
                    \beta_2\vect{A}_2+
                    \cdots+
                    \beta_s\vect{A}_s+
                    \cdots+
                    \left(\beta_t\alpha\right)\vect{A}_s+\beta_t\vect{A}_t+
                    \cdots+
                    \beta_m\vect{A}_m</mrow>
                    <mrow>&amp;=
                    \beta_1\vect{A}_1+
                    \beta_2\vect{A}_2+
                    \cdots+
                    \beta_s\vect{A}_s+\left(\beta_t\alpha\right)\vect{A}_s+
                    \cdots+
                    \beta_t\vect{A}_t+
                    \cdots+
                    \beta_m\vect{A}_m</mrow>
                    <mrow>&amp;=
                    \beta_1\vect{A}_1+
                    \beta_2\vect{A}_2+
                    \cdots+
                    \left(\beta_s+\beta_t\alpha\right)\vect{A}_s+
                    \cdots+
                    \beta_t\vect{A}_t+
                    \cdots+
                    \beta_m\vect{A}_m</mrow>
                    </md>says that <m>\csp{\transpose{B}}\subseteq\csp{\transpose{A}}</m>.  Similarly,
                    <!--  Hidden ampersand in first term to make spacing just fit --><md>
                    <mrow>\gamma_1&amp;\vect{A}_1+
                    \gamma_2\vect{A}_2+
                    \cdots+
                    \gamma_s\vect{A}_s+
                    \cdots+
                    \gamma_t\vect{A}_t+
                    \cdots+
                    \gamma_m\vect{A}_m</mrow>
                    <mrow>&amp;=
                    \gamma_1\vect{A}_1+
                    \gamma_2\vect{A}_2+
                    \cdots+
                    \gamma_s\vect{A}_s+
                    \cdots+
                    \left(-\alpha\gamma_t\vect{A}_s + \alpha\gamma_t\vect{A}_s\right)+\gamma_t\vect{A}_t+
                    \cdots+
                    \gamma_m\vect{A}_m</mrow>
                    <mrow>&amp;=
                    \gamma_1\vect{A}_1+
                    \gamma_2\vect{A}_2+
                    \cdots+
                    \left(-\alpha\gamma_t+\gamma_s\right)\vect{A}_s+
                    \cdots+
                    \gamma_t\left(\alpha\vect{A}_s+\vect{A}_t\right)+
                    \cdots+
                    \gamma_m\vect{A}_m</mrow>
                    <mrow>&amp;=
                    \gamma_1\vect{B}_1+
                    \gamma_2\vect{B}_2+
                    \cdots+
                    \left(-\alpha\gamma_t+\gamma_s\right)\vect{B}_s+
                    \cdots+
                    \gamma_t\vect{B}_t+
                    \cdots+
                    \gamma_m\vect{B}_m</mrow>
                </md>says that <m>\csp{\transpose{A}}\subseteq\csp{\transpose{B}}</m>.  So <m>\rsp{A}=\csp{\transpose{A}}=\csp{\transpose{B}}=\rsp{B}</m> when a single row operation of the third type is performed.</p>
                <p>So the row space of a matrix is preserved by each row operation, and hence row spaces of row-equivalent matrices are equal sets.</p>
            </proof>
        </theorem>
        <example xml:id="example-RSREM" acro="RSREM">
            <title>Row spaces of two row-equivalent matrices</title>
            <idx>
                <h>row-equivalent matrices</h>
                <h>row spaces</h>
            </idx>
            <p>In <xref ref="example-TREM" acro="TREM"/> we saw that the matrices<md>
                <mrow>A&amp;=\begin{bmatrix}
                2&amp;-1&amp;3&amp;4\\
                5&amp;2&amp;-2&amp;3\\
                1&amp;1&amp;0&amp;6
                \end{bmatrix}
                &amp;
                B&amp;=\begin{bmatrix}
                1&amp;1&amp;0&amp;6\\
                3&amp;0&amp;-2&amp;-9\\
                2&amp;-1&amp;3&amp;4
                \end{bmatrix}</mrow>
            </md>are row-equivalent by demonstrating a sequence of two row operations that converted <m>A</m> into <m>B</m>.  Applying <xref ref="theorem-REMRS" acro="REMRS"/> we can say<me>\rsp{A}=
            \spn{\set{\colvector{2\\-1\\3\\4},\,\colvector{5\\2\\-2\\3},\,\colvector{1\\1\\0\\6}}}=
            \spn{\set{\colvector{1\\1\\0\\6},\,\colvector{3\\0\\-2\\-9},\,\colvector{2\\-1\\3\\4}}}
            =\rsp{B}</me>.</p>
        </example>
        <p><xref ref="theorem-REMRS" acro="REMRS"/> is at its best when one of the row-equivalent matrices is in reduced row-echelon form.  The vectors that are zero rows can be ignored. (Who needs the zero vector when building a span? See <xref ref="exercise-LI-T10" acro="LI.T10"/>.)  The echelon pattern insures that the nonzero rows yield vectors that are linearly independent.  Here is the theorem.</p>
        <theorem xml:id="theorem-BRS" acro="BRS">
            <title>Basis for the Row Space</title>
            <idx>
                <h>row space</h>
                <h>basis</h>
            </idx>
            <statement>
                <p>Suppose that <m>A</m> is a matrix and <m>B</m> is a row-equivalent matrix in reduced row-echelon form.  Let <m>S</m> be the set of nonzero columns of <m>\transpose{B}</m>.  Then <ol>
                    <li><m>\rsp{A}=\spn{S}</m>.</li>
                    <li><m>S</m> is a linearly independent set.</li>
                </ol></p>
            </statement>
            <proof>
                <p>From <xref ref="theorem-REMRS" acro="REMRS"/> we know that <m>\rsp{A}=\rsp{B}</m>.  If <m>B</m> has any zero rows, these are columns of <m>\transpose{B}</m> that are the zero vector.  We can safely toss out the zero vector in the span construction, since it can be recreated from the nonzero vectors by a linear combination where all the scalars are zero.  So <m>\rsp{A}=\spn{S}</m>.</p>
                <p>Suppose <m>B</m> has <m>r</m> nonzero rows and let <m>D=\set{d_1,\,d_2,\,d_3,\,\ldots,\,d_r}</m> denote the  indices of the pivot columns of <m>B</m>.  Denote the <m>r</m> column vectors of <m>\transpose{B}</m>, the vectors in <m>S</m>, as <m>\vectorlist{B}{r}</m>.  To show that <m>S</m> is linearly independent, start with a relation of linear dependence<me>\lincombo{\alpha}{B}{r}=\zerovector</me></p>
                <p>Now consider this vector equality in location <m>d_i</m>.  Since <m>B</m> is in reduced row-echelon form, the entries of column <m>d_i</m> of <m>B</m> are all zero, except for a leading 1 in row <m>i</m>.  Thus, in <m>\transpose{B}</m>, row <m>d_i</m> is all zeros, excepting a 1 in column <m>i</m>.   So, for <m>1\leq i\leq r</m>,<md>
                    <mrow>0
                    &amp;=\vectorentry{\zerovector}{d_i}&amp;&amp;
                        <xref ref="definition-ZCV" acro="ZCV"/></mrow>
                    <mrow>&amp;=\vectorentry{\lincombo{\alpha}{B}{r}}{d_i}
                    &amp;&amp;
                        <xref ref="definition-RLDCV" acro="RLDCV"/></mrow>
                    <mrow>&amp;=
                    \vectorentry{\alpha_1\vect{B}_1}{d_i}+
                    \vectorentry{\alpha_2\vect{B}_2}{d_i}+
                    \vectorentry{\alpha_3\vect{B}_3}{d_i}+
                    \cdots+
                    \vectorentry{\alpha_r\vect{B}_r}{d_i}
                    &amp;&amp;
                        <xref ref="definition-MA" acro="MA"/></mrow>
                    <mrow>&amp;=
                    \alpha_1\vectorentry{\vect{B}_1}{d_i}+
                    \alpha_2\vectorentry{\vect{B}_2}{d_i}+
                    \alpha_3\vectorentry{\vect{B}_3}{d_i}+
                    \cdots+
                    \alpha_r\vectorentry{\vect{B}_r}{d_i}
                    &amp;&amp;
                        <xref ref="definition-MSM" acro="MSM"/></mrow>
                    <mrow>&amp;=
                    \alpha_1(0)+
                    \alpha_2(0)+
                    \alpha_3(0)+
                    \cdots+
                    \alpha_i(1)+
                    \cdots+
                    \alpha_r(0)
                    &amp;&amp;
                        <xref ref="definition-RREF" acro="RREF"/></mrow>
                    <mrow>&amp;=\alpha_i</mrow>
                    </md></p>
                <p>So we conclude that <m>\alpha_i=0</m> for all <m>1\leq i\leq r</m>, establishing the linear independence of <m>S</m>  (<xref ref="definition-LICV" acro="LICV"/>).</p>
            </proof>
        </theorem>
        <example xml:id="example-IAS" acro="IAS">
            <title>Improving a span</title>
            <idx>
                <h>span</h>
                <h>improved</h>
            </idx>
            <p>Suppose in the course of analyzing a matrix (its column space, its null space, its <ellipsis/>) we encounter the following set of vectors, described by a span<me>X=\spn{\set{
            \colvector{1\\2\\1\\6\\6},\,
            \colvector{3\\-1\\2\\-1\\6},\,
            \colvector{1\\-1\\0\\-1\\-2},\,
            \colvector{-3\\2\\-3\\6\\-10}
            }}</me>.</p>
            <p>Let <m>A</m> be the matrix whose rows are the vectors in <m>X</m>, so by design <m>X=\rsp{A}</m>.<me>A=
            \begin{bmatrix}
            1 &amp; 2 &amp; 1 &amp; 6 &amp; 6\\
            3 &amp; -1 &amp; 2 &amp; -1 &amp; 6\\
            1 &amp; -1 &amp; 0 &amp; -1 &amp; -2\\
            -3 &amp; 2 &amp; -3 &amp; 6 &amp; -10
            \end{bmatrix}</me></p>
            <p>Row-reduce <m>A</m> to form a row-equivalent matrix in reduced row-echelon form.<me>B=
            \begin{bmatrix}
            \leading{1} &amp; 0 &amp; 0 &amp; 2 &amp; -1\\
            0 &amp; \leading{1} &amp; 0 &amp; 3 &amp; 1\\
            0 &amp; 0 &amp; \leading{1} &amp; -2 &amp; 5\\
            0 &amp; 0 &amp; 0 &amp; 0 &amp; 0
            \end{bmatrix}</me></p>
            <p>Then <xref ref="theorem-BRS" acro="BRS"/> says we can grab the nonzero columns of <m>\transpose{B}</m> and write<me>X=\rsp{A}=\rsp{B}=
            \spn{\set{
            \colvector{1\\0\\0\\2\\-1},\,
            \colvector{0\\1\\0\\3\\1},\,
            \colvector{0\\0\\1\\-2\\5}
            }}</me>.</p>
            <p>These three vectors provide a much-improved description of <m>X</m>.  There are fewer vectors, and the pattern of zeros and ones in the first three entries makes it easier to determine membership in <m>X</m>.  </p>
        </example>
        <p>Notice that in <xref ref="example-IAS" acro="IAS"/> all we had to do was row-reduce the right matrix and toss out a zero row.  Next to row operations themselves, <xref ref="theorem-BRS" acro="BRS"/> <em>is probably the most powerful computational technique at your disposal</em> as it quickly provides a much improved description of a span, <em>any span</em> (row space, column space, <ellipsis/>).</p>
        <p><xref ref="theorem-BRS" acro="BRS"/> and the techniques of <xref ref="example-IAS" acro="IAS"/> will provide yet another description of the column space of a matrix.  First we state a triviality as a theorem, so we can reference it later.</p>
        <theorem xml:id="theorem-CSRST" acro="CSRST">
            <title>Column Space, Row Space, Transpose</title>
            <idx>
                <h>column space</h>
                <h>as row space</h>
            </idx>
            <statement>
                <idx>
                    <h>row space</h>
                    <h>as column space</h>
                </idx>
                <p>Suppose <m>A</m> is a matrix.  Then <m>\csp{A}=\rsp{\transpose{A}}</m>.</p>
            </statement>
            <proof>
                <p><md>
                    <mrow>\csp{A}
                    &amp;=\csp{\transpose{\left(\transpose{A}\right)}}&amp;&amp;
                        <xref ref="theorem-TT" acro="TT"/></mrow>
                    <mrow>&amp;=\rsp{\transpose{A}}&amp;&amp;
                        <xref ref="definition-RSM" acro="RSM"/></mrow>
                </md></p>
            </proof>
        </theorem>
        <p>So to find another expression for the column space of a matrix, build its transpose, row-reduce it, toss out the zero rows, and convert the nonzero rows to column vectors to yield an improved set for the span construction.  We will do Archetype<nbsp/><xref ref="archetype-I" acro="I" text="global"/>, then you do Archetype<nbsp/><xref ref="archetype-J" acro="J" text="global"/>.</p>
        <example xml:id="example-CSROI" acro="CSROI">
            <title>Column space from row operations, Archetype I</title>
            <idx>
                <h>column space</h>
                <h>row operations, Archetype I</h>
            </idx>
            <idx>
                <h>Archetype I</h>
                <h>column space from row operations</h>
            </idx>
            <!-- Archetype I, Part purematrix -->
            <p>To find the column space of the coefficient matrix of Archetype<nbsp/><xref ref="archetype-I" acro="I" text="global"/>, we proceed as follows.  The matrix is<me>I=\begin{bmatrix}
             1 &amp; 4 &amp; 0 &amp; -1 &amp; 0 &amp; 7 &amp;  -9 \\
             2 &amp; 8 &amp;  -1 &amp; 3 &amp; 9 &amp;  -13 &amp; 7\\
             0 &amp; 0 &amp;  2 &amp; -3 &amp; -4 &amp; 12 &amp;  -8\\
             -1 &amp;  -4 &amp; 2 &amp; 4 &amp; 8 &amp;  -31 &amp; 37
            \end{bmatrix}</me>.  The transpose is<me>\begin{bmatrix}
            1 &amp; 2 &amp; 0 &amp; -1\\
            4 &amp; 8 &amp; 0 &amp; -4\\
            0 &amp; -1 &amp; 2 &amp; 2\\
            -1 &amp; 3 &amp; -3 &amp; 4\\
            0 &amp; 9 &amp; -4 &amp; 8\\
            7 &amp; -13 &amp; 12 &amp; -31\\
            -9 &amp; 7 &amp; -8 &amp; 37
            \end{bmatrix}</me>.</p>
            <p>Row-reduced this becomes,<me>\begin{bmatrix}
            \leading{1} &amp; 0 &amp; 0 &amp; -\frac{31}{7}\\
            0 &amp; \leading{1} &amp; 0 &amp; \frac{12}{7}\\
            0 &amp; 0 &amp; \leading{1} &amp; \frac{13}{7}\\
            0 &amp; 0 &amp; 0 &amp; 0\\
            0 &amp; 0 &amp; 0 &amp; 0\\
            0 &amp; 0 &amp; 0 &amp; 0\\
            0 &amp; 0 &amp; 0 &amp; 0
            \end{bmatrix}</me>.</p>
            <p>Now, using <xref ref="theorem-CSRST" acro="CSRST"/> and <xref ref="theorem-BRS" acro="BRS"/><me>\csp{I}=\rsp{\transpose{I}}=
            \spn{\set{
            \colvector{1\\0\\0\\-\frac{31}{7}},\,
            \colvector{0\\1\\0\\\frac{12}{7}},\,
            \colvector{0\\0\\1\\\frac{13}{7}}
            }}</me>.</p>
            <p>This is a very nice description of the column space.  Fewer vectors than the 7 involved in the definition, and the pattern of the zeros and ones in the first 3 slots can be used to advantage.  For example, Archetype<nbsp/><xref ref="archetype-I" acro="I" text="global"/> is presented as a consistent system of equations with a vector of constants<me>\vect{b}=\colvector{3\\9\\1\\4}</me>.</p>
            <p>Since <m>\linearsystem{I}{\vect{b}}</m> is consistent, <xref ref="theorem-CSCS" acro="CSCS"/> tells us that <m>\vect{b}\in\csp{I}</m>.  But we could see this quickly with the following computation, which really only involves any work in the 4th entry of the vectors as the scalars in the linear combination are <em>dictated</em> by the first three entries of <m>\vect{b}</m>.<me>\vect{b}=\colvector{3\\9\\1\\4}=
            3\colvector{1\\0\\0\\-\frac{31}{7}}+
            9\colvector{0\\1\\0\\\frac{12}{7}}+
            1\colvector{0\\0\\1\\\frac{13}{7}}</me></p>
            <p>Can you now rapidly construct several vectors, <m>\vect{b}</m>, so that <m>\linearsystem{I}{\vect{b}}</m> is consistent, and several more so that the system is inconsistent?</p>
        </example>
        <computation xml:id="sage-RSM" acro="RSM">
            <title>Row Space of a Matrix</title>
            <idx>row space</idx>
            <p>Not to be outdone, and not suprisingly, Sage can compute a row space with the matrix method <c>.row_space()</c>.  Indeed, given Sage's penchant for treating vectors as rows, much of Sage's infrastructure for vector spaces ultimately relies on <xref ref="theorem-REMRS" acro="REMRS"/>.  More on that in Sage<nbsp/><xref ref="sage-SUTH0" acro="SUTH0" text="global"/>.  For now, we reprise <xref ref="example-IAS" acro="IAS"/> as an illustration.</p>
            <sage xml:id="sagecell-RSM-1">
                <input>
                v1 = vector(QQ, [1,  2,  1,  6,   6])
                v2 = vector(QQ, [3, -1,  2, -1,   6])
                v3 = vector(QQ, [1, -1,  0, -1,  -2])
                v4 = vector(QQ, [-3, 2, -3,  6, -10])
                X = (QQ^5).span([v1, v2, v3, v4])
                A = matrix([v1, v2, v3, v4])
                rsA = A.row_space()
                X == rsA
                </input>
                <output>
                True
                </output>
            </sage>
            <sage xml:id="sagecell-RSM-2">
                <input>
                B = A.rref()
                rsB = B.row_space()
                X == rsB
                </input>
                <output>
                True
                </output>
            </sage>
            <sage xml:id="sagecell-RSM-3">
                <input>
                X
                </input>
                <output>
                Vector space of degree 5 and dimension 3 over Rational Field
                Basis matrix:
                [ 1  0  0  2 -1]
                [ 0  1  0  3  1]
                [ 0  0  1 -2  5]
                </output>
            </sage>
            <sage xml:id="sagecell-RSM-4">
                <input>
                X.basis()
                </input>
                <output>
                [
                (1, 0, 0, 2, -1),
                (0, 1, 0, 3, 1),
                (0, 0, 1, -2, 5)
                ]
                </output>
            </sage>
            <sage xml:id="sagecell-RSM-5">
                <input>
                B
                </input>
                <output>
                [ 1  0  0  2 -1]
                [ 0  1  0  3  1]
                [ 0  0  1 -2  5]
                [ 0  0  0  0  0]
                </output>
            </sage>
            <p>We begin with the same four vectors in <xref ref="example-IAS" acro="IAS"/> and create their span, the vector space <c>X</c>.  The matrix <c>A</c> has these four vectors as rows and <c>B</c> is the reduced row-echelon form of <c>A</c>.  Then the row spaces of <c>A</c> and <c>B</c> are equal to the vector space <c>X</c> (and each other).  The way Sage describes this vector space is with a matrix whose rows <em>are the nonzero rows of the reduced row-echelon form of the matrix</em> <c>A</c>.  This is <xref ref="theorem-BRS" acro="BRS"/> in action where we go with Sage's penchant for rows and ignore the text's penchant for columns.</p>
            <p>We can illustrate a few other results about row spaces with Sage.  Discussion follows.</p>
            <sage xml:id="sagecell-RSM-6">
                <input>
                A = matrix(QQ,[[1,  1, 0, -1,  1,  1, 0],
                               [4,  5, 1, -6,  1,  6, 1],
                               [5,  5, 1, -5,  4,  5, 2],
                               [3, -1, 0,  5, 11, -5, 4]])
                A.row_space() == A.transpose().column_space()
                </input>
                <output>
                True
                </output>
            </sage>
            <sage xml:id="sagecell-RSM-7">
                <input>
                B = matrix(QQ,[[ 7,  9, 2, -11,   1, 11,  2],
                               [-4, -3, 1,   2,  -7, -2,  1],
                               [16,  8, 2,   0,  30,  0, 12],
                               [ 2, 10, 2, -18, -16, 18, -4]])
                B.column_space() == B.transpose().row_space()
                </input>
                <output>
                True
                </output>
            </sage>
            <sage xml:id="sagecell-RSM-8">
                <input>
                A.rref() == B.rref()
                </input>
                <output>
                True
                </output>
            </sage>
            <sage xml:id="sagecell-RSM-9">
                <input>
                A.row_space() == B.row_space()
                </input>
                <output>
                True
                </output>
            </sage>
            <p>We use the matrix <c>A</c> to illustrate <xref ref="definition-RSM" acro="RSM"/>, and the matrix <c>B</c> to illustrate <xref ref="theorem-CSRST" acro="CSRST"/>.  <c>A</c> and <c>B</c> were designed to have the same reduced row-echelon form, and hence be row-equivalent, so this is not a consequence of any theorem or previous computation.  However, then <xref ref="theorem-REMRS" acro="REMRS"/> guarantees that the row spaces of <c>A</c> and <c>B</c> are equal.</p>
        </computation>
    </subsection>
    <exercises xml:id="readingquestions-CRS">
        <title>Reading Questions</title>
        <exercise xml:id="reading-CRS-1">
            <statement>
                <p>Write the column space of the matrix below as the span of a set of three vectors and explain your choice of method.<me>\begin{bmatrix}
                1 &amp; 3 &amp; 1 &amp; 3\\
                2 &amp; 0 &amp; 1 &amp; 1\\
                -1 &amp; 2 &amp; 1 &amp; 0
                \end{bmatrix}</me></p>
            </statement>
        </exercise>
        <exercise xml:id="reading-CRS-2">
            <statement>
                <p>Suppose that <m>A</m> is an <m>n\times n</m> nonsingular matrix. What can you say about its column space?</p>
            </statement>
        </exercise>
        <exercise xml:id="reading-CRS-3">
            <statement>
                <p> Is the vector <m>\colvector{0\\5\\2\\3}</m> in the row space of the following matrix?  Why or why not?<me>\begin{bmatrix}
                1 &amp; 3 &amp; 1 &amp; 3\\
                2 &amp; 0 &amp; 1 &amp; 1\\
                -1 &amp; 2 &amp; 1 &amp; 0
                \end{bmatrix}</me></p>
            </statement>
        </exercise>
    </exercises>
    <exercises xml:id="exercises-CRS">
        <title>Exercises</title>
        <exercise number="C20" xml:id="exercise-CRS-C20">
            <statement contributor="chrisblack">
                <p>For each matrix below, find a set of linearly independent vectors <m>X</m> so that <m>\spn{X}</m> equals the column space of the matrix, and a set of linearly independent vectors <m>Y</m> so that <m>\spn{Y}</m> equals the row space of the matrix.<md>
                <mrow>A&amp;=
                \begin{bmatrix} 1 &amp; 2 &amp; 3 &amp; 1 \\
                0 &amp; 1 &amp; 1 &amp; 2\\
                1 &amp; -1 &amp; 2 &amp; 3 \\
                1 &amp; 1 &amp; 2 &amp; -1 \end{bmatrix}
                &amp;
                B&amp;=
                \begin{bmatrix}  1 &amp; 2 &amp; 1 &amp; 1 &amp; 1 \\
                3 &amp; 2 &amp; -1 &amp; 4 &amp; 5\\
                0 &amp; 1 &amp; 1 &amp; 1 &amp; 2
                \end{bmatrix}
                &amp;
                C&amp;
                =\begin{bmatrix}
                2 &amp; 1 &amp; 0 \\
                3 &amp; 0 &amp; 3\\
                1 &amp; 2 &amp; -3 \\
                1 &amp; 1 &amp; -1 \\
                1 &amp; 1 &amp; -1\end{bmatrix}</mrow>
                </md>From your results for these three matrices, can you formulate a conjecture about the sets <m>X</m> and <m>Y</m>?</p>
            </statement>
        </exercise>
        <exercise number="C30" xml:id="exercise-CRS-C30">
            <statement>
                <p><xref ref="example-CSOCD" acro="CSOCD"/> expresses the column space of the coefficient matrix from Archetype<nbsp/><xref ref="archetype-D" acro="D" text="global"/> (call the matrix <m>A</m> here) as the span of the first two columns of <m>A</m>.  In <xref ref="example-CSMCS" acro="CSMCS"/> we determined that the vector<me>\vect{c}=\colvector{2\\3\\2}</me><em>was not</em> in the column space of <m>A</m>  and that the vector<me>\vect{b}=\colvector{8\\-12\\4}</me><em>was</em> in the column space of <m>A</m>.   Attempt to write <m>\vect{c}</m> and <m>\vect{b}</m> as linear combinations of the two vectors in the span construction for the column space in <xref ref="example-CSOCD" acro="CSOCD"/> and record your observations.</p>
            </statement>
            <solution xml:id="solution-CRS-C30">
                <p>In each case, begin with a vector equation where one side contains a linear combination of the two vectors from the span construction that gives the column space of <m>A</m> with unknowns for scalars, and then use <xref ref="theorem-SLSLC" acro="SLSLC"/> to set up a system of equations.  For <m>\vect{c}</m>, the resulting system has no solution, as we would expect.</p>
                <p>For <m>\vect{b}</m> there is a solution, as we would expect.  What is interesting is that the solution is unique.  This is a consequence of the linear independence of the set of two vectors in the span construction.  If we wrote <m>\vect{b}</m> as a linear combination of all four columns of <m>A</m>, then there would be infinitely many ways to do this.</p>
            </solution>
        </exercise>
        <exercise number="C31" xml:id="exercise-CRS-C31">
            <statement>
                <p>For the matrix <m>A</m> below find a set of vectors <m>T</m> meeting the following requirements:  (1) the span of <m>T</m> is the column space of <m>A</m>, that is, <m>\spn{T}=\csp{A}</m>, (2) <m>T</m> is linearly independent, and (3) the elements of <m>T</m> are columns of <m>A</m>.<me>A=
                \begin{bmatrix}
                 2 &amp; 1 &amp; 4 &amp; -1 &amp; 2 \\
                 1 &amp; -1 &amp; 5 &amp; 1 &amp; 1 \\
                 -1 &amp; 2 &amp; -7 &amp; 0 &amp; 1 \\
                 2 &amp; -1 &amp; 8 &amp; -1 &amp; 2
                \end{bmatrix}</me></p>
            </statement>
            <solution xml:id="solution-CRS-C31">
                <p><xref ref="theorem-BCS" acro="BCS"/> is the right tool for this problem.  Row-reduce this matrix, identify the pivot columns and then grab the columns of <m>A</m> with the same indices for the set <m>T</m>.  The matrix <m>A</m> row-reduces to<me>\begin{bmatrix}
                 \leading{1} &amp; 0 &amp; 3 &amp; 0 &amp; 0 \\
                 0 &amp; \leading{1} &amp; -2 &amp; 0 &amp; 0 \\
                 0 &amp; 0 &amp; 0 &amp; \leading{1} &amp; 0 \\
                 0 &amp; 0 &amp; 0 &amp; 0 &amp; \leading{1}
                \end{bmatrix}</me>So <m>D=\set{1,\,2,\,4,\,5}</m> and then<me>T=\set{\vect{A}_1,\,\vect{A}_2,\,\vect{A}_4,\,\vect{A}_5}=
                \set{
                \colvector{2 \\ 1 \\ -1 \\ 2},\,
                \colvector{1 \\ -1 \\ 2 \\ -1},\,
                \colvector{-1 \\ 1 \\ 0 \\ -1},\,
                \colvector{2 \\ 1 \\ 1 \\ 2}
                }</me>has the requested properties.</p>
            </solution>
        </exercise>
        <exercise number="C32" xml:id="exercise-CRS-C32">
            <statement>
                <p>In <xref ref="example-CSAA" acro="CSAA"/>, verify that the vector <m>\vect{b}</m> is not in the column space of the coefficient matrix.</p>
            </statement>
        </exercise>
        <exercise number="C33" xml:id="exercise-CRS-C33">
            <statement>
                <p>Find a linearly independent set <m>S</m> so that the span of <m>S</m>, <m>\spn{S}</m>, is row space of the matrix <m>B</m>, and <m>S</m> is linearly independent.<me>B=
                \begin{bmatrix}
                2 &amp; 3 &amp; 1 &amp; 1\\
                1 &amp; 1 &amp; 0 &amp; 1\\
                -1 &amp; 2 &amp; 3 &amp; -4
                \end{bmatrix}</me></p>
            </statement>
            <solution xml:id="solution-CRS-C33">
                <p><xref ref="theorem-BRS" acro="BRS"/> is the most direct route to a set with these properties.  Row-reduce, toss zero rows, keep the others.  You could also transpose the matrix, then look for the column space by row-reducing the transpose and applying <xref ref="theorem-BCS" acro="BCS"/>.  We will do the former,<me>B\rref
                \begin{bmatrix}
                \leading{1} &amp; 0 &amp; -1 &amp; 2\\
                0 &amp; \leading{1} &amp; 1 &amp; -1\\
                0 &amp; 0 &amp; 0 &amp; 0
                \end{bmatrix}</me>So the set <m>S</m> is<me>S=\set{
                \colvector{1\\0\\-1\\2},\,
                \colvector{0\\1\\1\\-1}
                }</me></p>
            </solution>
        </exercise>
        <exercise number="C34" xml:id="exercise-CRS-C34">
            <statement>
                <p>For the <m>3\times 4</m> matrix <m>A</m> and the column vector <m>\vect{y}\in\complex{4}</m> given below, determine if <m>\vect{y}</m> is in the row space of <m>A</m>. In other words, answer the question:  <m>\vect{y}\in\rsp{A}</m>?<md>
                    <mrow>A&amp;=
                    \begin{bmatrix}
                     -2 &amp; 6 &amp; 7 &amp; -1 \\
                     7 &amp; -3 &amp; 0 &amp; -3 \\
                     8 &amp; 0 &amp; 7 &amp; 6
                    \end{bmatrix}
                    &amp;
                    \vect{y}&amp;=
                    \colvector{2\\1\\3\\-2}</mrow>
                </md></p>
            </statement>
            <solution xml:id="solution-CRS-C34">
                <p><md>
                    <mrow>\vect{y}\in\rsp{A}
                    &amp;\iff\vect{y}\in\csp{\transpose{A}}&amp;&amp;
                        <xref ref="definition-RSM" acro="RSM"/></mrow>
                    <mrow>&amp;\iff\linearsystem{\transpose{A}}{\vect{y}}\text{ is consistent}&amp;&amp;
                        <xref ref="theorem-CSCS" acro="CSCS"/></mrow>
                    </md>The augmented matrix <m>\augmented{\transpose{A}}{\vect{y}}</m> row reduces to<md>
                    <mrow>\begin{bmatrix}
                     \leading{1} &amp; 0 &amp; 0 &amp; 0 \\
                     0 &amp; \leading{1} &amp; 0 &amp; 0 \\
                     0 &amp; 0 &amp; \leading{1} &amp; 0 \\
                     0 &amp; 0 &amp; 0 &amp; \leading{1}
                    \end{bmatrix}</mrow>
                </md>and since the final column is a pivot column <xref ref="theorem-RCLS" acro="RCLS"/> tells us the linear system is inconsistent and so <m>\vect{y}\not\in\rsp{A}</m>.</p>
            </solution>
        </exercise>
        <exercise number="C35" xml:id="exercise-CRS-C35">
            <statement>
                <p>For the matrix <m>A</m> below, find two different linearly independent sets whose spans equal the column space of <m>A</m>, <m>\csp{A}</m>, such that<ol>
                    <li>the elements are each columns of <m>A</m>.</li>
                    <li>the set is obtained by a procedure that is substantially different from the procedure you use in part (1).</li>
                </ol><md>
                    <mrow>A&amp;=
                    \begin{bmatrix}
                     3 &amp; 5 &amp; 1 &amp; -2 \\
                     1 &amp; 2 &amp; 3 &amp; 3 \\
                     -3 &amp; -4 &amp; 7 &amp; 13
                    \end{bmatrix}</mrow>
                    </md></p>
            </statement>
            <solution xml:id="solution-CRS-C35">
                <p>(a)\quad By <xref ref="theorem-BCS" acro="BCS"/> we can row-reduce <m>A</m>, identify pivot columns with the set <m>D</m>, and <q>keep</q> those columns of <m>A</m> and we will have a set with the desired properties.<md>
                    <mrow>A\rref
                    \begin{bmatrix}
                     \leading{1} &amp; 0 &amp; -13 &amp; -19 \\
                     0 &amp; \leading{1} &amp; 8 &amp; 11 \\
                     0 &amp; 0 &amp; 0 &amp; 0
                    \end{bmatrix}</mrow>
                </md>So we have the set of pivot columns <m>D=\set{1,\,2}</m> and we <q>keep</q> the first two columns of <m>A</m>,<md>
                <mrow>\set{
                \colvector{3\\1\\-3},\,
                \colvector{5\\2\\-4}
                }</mrow>
            </md>(b)\quad We can view the column space as the row space of the transpose (<xref ref="theorem-CSRST" acro="CSRST"/>).  We can get a basis of the row space of a matrix quickly by bringing the matrix to reduced row-echelon form and keeping the nonzero rows as column vectors (<xref ref="theorem-BRS" acro="BRS"/>).  Here goes.<md>
                <mrow>\transpose{A}\rref
                \begin{bmatrix}
                 \leading{1} &amp; 0 &amp; -2 \\
                 0 &amp; \leading{1} &amp; 3 \\
                 0 &amp; 0 &amp; 0 \\
                 0 &amp; 0 &amp; 0
                \end{bmatrix}</mrow>
                </md>Taking the nonzero rows and tilting them up as columns gives us<md>
                    <mrow>\set{
                    \colvector{1\\0\\-2},\,
                    \colvector{0\\1\\3}
                    }</mrow>
                </md>An approach based on the matrix <m>L</m> from extended echelon form (<xref ref="definition-EEF" acro="EEF"/>) and <xref ref="theorem-FS" acro="FS"/> will work as well as an alternative approach.</p>
            </solution>
        </exercise>
        <exercise number="C40" xml:id="exercise-CRS-C40">
            <statement>
                <p>The following archetypes are systems of equations.  For each system, write the vector of constants as a linear combination of the vectors in the span construction for the column space provided by <xref ref="theorem-BCS" acro="BCS"/> (these vectors are listed for each of these archetypes).</p>
                <p>Archetype<nbsp/><xref ref="archetype-A" acro="A" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-B" acro="B" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-C" acro="C" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-D" acro="D" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-E" acro="E" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-F" acro="F" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-G" acro="G" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-H" acro="H" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-I" acro="I" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-J" acro="J" text="global"/></p>
            </statement>
        </exercise>
        <exercise number="C42" xml:id="exercise-CRS-C42">
            <statement>
                <p>The following archetypes are either matrices or systems of equations with coefficient matrices.  For each matrix, compute a set of column vectors such that (1) the vectors are columns of the matrix, (2) the set is linearly independent, and (3) the span of the set is the column space of the matrix.  See <xref ref="theorem-BCS" acro="BCS"/>.</p>
                <p>Archetype<nbsp/><xref ref="archetype-A" acro="A" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-B" acro="B" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-C" acro="C" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-D" acro="D" text="global"/>/Archetype<nbsp/><xref ref="archetype-E" acro="E" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-F" acro="F" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-G" acro="G" text="global"/>/Archetype<nbsp/><xref ref="archetype-H" acro="H" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-I" acro="I" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-J" acro="J" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-K" acro="K" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-L" acro="L" text="global"/></p>
            </statement>
        </exercise>
        <exercise number="C50" xml:id="exercise-CRS-C50">
            <statement>
                <p>The following archetypes are either matrices or systems of equations with coefficient matrices.  For each matrix, compute a set of column vectors such that  (1) the set is linearly independent, and (2) the span of the set is the row space of the matrix.  See <xref ref="theorem-BRS" acro="BRS"/>.</p>
                <p>Archetype<nbsp/><xref ref="archetype-A" acro="A" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-B" acro="B" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-C" acro="C" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-D" acro="D" text="global"/>/Archetype<nbsp/><xref ref="archetype-E" acro="E" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-F" acro="F" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-G" acro="G" text="global"/>/Archetype<nbsp/><xref ref="archetype-H" acro="H" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-I" acro="I" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-J" acro="J" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-K" acro="K" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-L" acro="L" text="global"/></p>
            </statement>
        </exercise>
        <exercise number="C51" xml:id="exercise-CRS-C51">
            <statement>
                <p>The following archetypes are either matrices or systems of equations with coefficient matrices.  For each matrix, compute the column space as the span of a linearly independent set as follows: transpose the matrix, row-reduce, toss out zero rows, convert rows into column vectors. See <xref ref="example-CSROI" acro="CSROI"/>.</p>
                <p>Archetype<nbsp/><xref ref="archetype-A" acro="A" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-B" acro="B" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-C" acro="C" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-D" acro="D" text="global"/>/Archetype<nbsp/><xref ref="archetype-E" acro="E" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-F" acro="F" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-G" acro="G" text="global"/>/Archetype<nbsp/><xref ref="archetype-H" acro="H" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-I" acro="I" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-J" acro="J" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-K" acro="K" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-L" acro="L" text="global"/></p>
            </statement>
        </exercise>
        <exercise number="C52" xml:id="exercise-CRS-C52">
            <statement>
                <p>The following archetypes are systems of equations.  For each different coefficient matrix build two new vectors of constants.  The first should lead to a consistent system and the second should lead to an inconsistent system.  Descriptions of the column space as spans of linearly independent sets of vectors with <q>nice patterns</q> of zeros and ones might be most useful and instructive in connection with this exercise. (See the end of <xref ref="example-CSROI" acro="CSROI"/>.)</p>
                <p>Archetype<nbsp/><xref ref="archetype-A" acro="A" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-B" acro="B" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-C" acro="C" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-D" acro="D" text="global"/>/Archetype<nbsp/><xref ref="archetype-E" acro="E" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-F" acro="F" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-G" acro="G" text="global"/>/Archetype<nbsp/><xref ref="archetype-H" acro="H" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-I" acro="I" text="global"/>,
                Archetype<nbsp/><xref ref="archetype-J" acro="J" text="global"/></p>
            </statement>
        </exercise>
        <exercise number="M10" xml:id="exercise-CRS-M10">
            <statement>
                <p>For the matrix <m>E</m> below, find vectors <m>\vect{b}</m> and <m>\vect{c}</m> so that the system <m>\linearsystem{E}{\vect{b}}</m> is consistent and <m>\linearsystem{E}{\vect{c}}</m> is inconsistent.<me>E=
                \begin{bmatrix}
                -2 &amp; 1 &amp; 1 &amp; 0\\
                3 &amp; -1 &amp; 0 &amp; 2\\
                4 &amp; 1 &amp; 1 &amp; 6
                \end{bmatrix}</me></p>
            </statement>
            <solution xml:id="solution-CRS-M10">
                <p>Any vector from <m>\complex{3}</m> will lead to a consistent system, and therefore there is no vector that will lead to an inconsistent system.</p>
                <p>How do we convince ourselves of this?  First, row-reduce <m>E</m>,<me>E\rref
                \begin{bmatrix}
                \leading{1} &amp; 0 &amp; 0 &amp; 1\\
                0 &amp; \leading{1} &amp; 0 &amp; 1\\
                0 &amp; 0 &amp; \leading{1} &amp; 1
                \end{bmatrix}</me>.  If we augment <m>E</m> with any vector of constants, and row-reduce the augmented matrix, we will never find a pivot column in the final column, so by <xref ref="theorem-RCLS" acro="RCLS"/> the system will always be consistent.</p>
                <p>Said another way, the column space of <m>E</m> is all of <m>\complex{3}</m>, <m>\csp{E}=\complex{3}</m>.  So by <xref ref="theorem-CSCS" acro="CSCS"/> any vector of constants will create a consistent system (and none will create an inconsistent system).</p>
            </solution>
        </exercise>
        <exercise number="M20" xml:id="exercise-CRS-M20">
            <statement>
                <p>Usually the column space and null space of a matrix contain vectors of different sizes.  For a square matrix, though, the vectors in these two sets are the same size.  Usually the two sets will be different.  Construct an example of a square matrix where the column space and null space are equal.</p>
            </statement>
            <solution xml:id="solution-CRS-M20">
                <p>The <m>2\times 2</m> matrix<me>\begin{bmatrix}
                1&amp;1\\
                -1&amp;-1
                \end{bmatrix}</me>has <m>\csp{A}=\nsp{A}=\spn{\set{\colvector{1\\-1}}}</m>.</p>
            </solution>
        </exercise>
        <exercise number="M21" xml:id="exercise-CRS-M21">
            <statement>
                <p>We have a variety of theorems about how to create column spaces and row spaces and they frequently involve row-reducing a matrix.  Here is a procedure that some try to use to get a column space.  Begin with an <m>m\times n</m> matrix <m>A</m> and row-reduce to a matrix <m>B</m> with columns <m>\vectorlist{B}{n}</m>.  Then form the column space of <m>A</m> as<me>\csp{A}=
                \spn{\set{\vectorlist{B}{n}}}
                =\csp{B}</me>.  This is <em>not</em> not a legitimate procedure, and therefore is <em>not</em> a theorem.  Construct an example to show that the procedure will not in general create the column space of <m>A</m>.</p>
            </statement>
            <solution xml:id="solution-CRS-M21">
                <p>Begin with a matrix <m>A</m> (of any size) that does not have any zero rows, but which when row-reduced to <m>B</m> yields at least one row of zeros.  Such a matrix should be easy to construct (or find, like say from Archetype<nbsp/><xref ref="archetype-A" acro="A" text="global"/>).</p>
                <p><m>\csp{A}</m> will contain some vectors whose final slot (entry <m>m</m>) is nonzero, however, every column vector from the matrix <m>B</m> will have a zero in slot <m>m</m> and so every vector in <m>\csp{B}</m> will also contain a zero in the final slot.  This means that <m>\csp{A}\neq\csp{B}</m>, since we have vectors in <m>\csp{A}</m> that cannot be elements of <m>\csp{B}</m>.</p>
            </solution>
        </exercise>
        <exercise number="T40" xml:id="exercise-CRS-T40">
            <statement>
                <p>Suppose that <m>A</m> is an <m>m\times n</m> matrix and <m>B</m> is an <m>n\times p</m> matrix.  Prove that the column space of <m>AB</m> is a subset of the column space of <m>A</m>, that is <m>\csp{AB}\subseteq\csp{A}</m>.  Provide an example where the opposite is false, in other words give an example where <m>\csp{A}\not\subseteq\csp{AB}</m>.   (Compare with <xref ref="exercise-MM-T40" acro="MM.T40"/>.)</p>
            </statement>
            <solution xml:id="solution-CRS-T40">
                <p>Choose <m>\vect{x}\in\csp{AB}</m>.  Then by <xref ref="theorem-CSCS" acro="CSCS"/> there is a vector <m>\vect{w}</m> that is a solution to <m>\linearsystem{AB}{\vect{x}}</m>.  Define the vector <m>\vect{y}</m> by <m>\vect{y}=B\vect{w}</m>.  We are set.<md>
                    <mrow>A\vect{y}
                    &amp;=A\left(B\vect{w}\right)&amp;&amp;
                        \text{Definition of }\vect{y}</mrow>
                    <mrow>&amp;=\left(AB\right)\vect{w}&amp;&amp;
                        <xref ref="theorem-MMA" acro="MMA"/></mrow>
                    <mrow>&amp;=\vect{x}&amp;&amp;
                        \vect{w}\text{ solution to }\linearsystem{AB}{\vect{x}}</mrow>
                </md>This says that <m>\linearsystem{A}{\vect{x}}</m> is a consistent system, and by <xref ref="theorem-CSCS" acro="CSCS"/>, we see that <m>\vect{x}\in\csp{A}</m> and therefore <m>\csp{AB}\subseteq\csp{A}</m>.</p>
                <p>For an example where <m>\csp{A}\not\subseteq\csp{AB}</m> choose <m>A</m> to be any nonzero matrix and choose <m>B</m> to be a zero matrix.  Then <m>\csp{A}\neq\set{\zerovector}</m> and <m>\csp{AB}=\csp{\zeromatrix}=\set{\zerovector}</m>.</p>
            </solution>
        </exercise>
        <exercise number="T41" xml:id="exercise-CRS-T41">
            <statement>
                <p>Suppose that <m>A</m> is an <m>m\times n</m> matrix and <m>B</m> is an <m>n\times n</m> nonsingular matrix.  Prove that the column space of <m>A</m> is equal to the column space of <m>AB</m>, that is <m>\csp{A}=\csp{AB}</m>.  (Compare with <xref ref="exercise-MM-T41" acro="MM.T41"/> and <xref ref="exercise-CRS-T40" acro="CRS.T40"/>.)</p>
            </statement>
            <solution xml:id="solution-CRS-T41">
                <p>From the solution to <xref ref="exercise-CRS-T40" acro="CRS.T40"/> we know that <m>\csp{AB}\subseteq\csp{A}</m>.  So to establish the set equality (<xref ref="definition-SE" acro="SE"/>) we need to show that <m>\csp{A}\subseteq\csp{AB}</m>.</p>
                <p>Choose <m>\vect{x}\in\csp{A}</m>.  By <xref ref="theorem-CSCS" acro="CSCS"/> the linear system <m>\linearsystem{A}{\vect{x}}</m> is consistent, so let <m>\vect{y}</m> be one such solution.  Because <m>B</m> is nonsingular, and linear system using <m>B</m> as a coefficient matrix will have a solution (<xref ref="theorem-NMUS" acro="NMUS"/>).  Let <m>\vect{w}</m> be the unique solution to the linear system <m>\linearsystem{B}{\vect{y}}</m>.  All set, here we go,<md>
                    <mrow>\left(AB\right)\vect{w}
                    &amp;=A\left(B\vect{w}\right)&amp;&amp;
                        <xref ref="theorem-MMA" acro="MMA"/></mrow>
                    <mrow>&amp;=A\vect{y}&amp;&amp;
                        \vect{w}\text{ solution to }\linearsystem{B}{\vect{y}}</mrow>
                    <mrow>&amp;=\vect{x}&amp;&amp;
                        \vect{y}\text{ solution to }\linearsystem{A}{\vect{x}}</mrow>
                </md>.  This says that the linear system <m>\linearsystem{AB}{\vect{x}}</m> is consistent, so by <xref ref="theorem-CSCS" acro="CSCS"/>, <m>\vect{x}\in\csp{AB}</m>.  So <m>\csp{A}\subseteq\csp{AB}</m>.</p>
            </solution>
        </exercise>
        <exercise number="T45" xml:id="exercise-CRS-T45">
            <statement>
                <p>Suppose that <m>A</m> is an <m>m\times n</m> matrix and <m>B</m> is an <m>n\times m</m> matrix where <m>AB</m> is a nonsingular matrix.  Prove that<ol>
                    <li><m>\nsp{B}=\set{\zerovector}</m></li>
                    <li><m>\csp{B}\cap\nsp{A}=\set{\zerovector}</m></li>
                </ol>Discuss the case when <m>m=n</m> in connection with <xref ref="theorem-NPNT" acro="NPNT"/>.</p>
            </statement>
            <solution xml:id="solution-CRS-T45">
                <p>First, <m>\zerovector\in\nsp{B}</m> trivially.  Now suppose that <m>\vect{x}\in\nsp{B}</m>.  Then<md>
                    <mrow>AB\vect{x}
                    &amp;=A(B\vect{x})&amp;&amp;
                        <xref ref="theorem-MMA" acro="MMA"/></mrow>
                    <mrow>&amp;=A\zerovector&amp;&amp;\vect{x}\in\nsp{B}</mrow>
                    <mrow>&amp;=\zerovector&amp;&amp;
                        <xref ref="theorem-MMZM" acro="MMZM"/></mrow>
                </md>.  Since we have assumed <m>AB</m> is nonsingular, <xref ref="definition-NM" acro="NM"/> implies that <m>\vect{x}=\zerovector</m>.</p>
                <p>Second, <m>\zerovector\in\csp{B}</m> and <m>\zerovector\in\nsp{A}</m> trivially, and so the zero vector is in the intersection as well (<xref ref="definition-SI" acro="SI"/>).  Now suppose that <m>\vect{y}\in\csp{B}\cap\nsp{A}</m>.  Because <m>\vect{y}\in\csp{B}</m>, <xref ref="theorem-CSCS" acro="CSCS"/> says the system <m>\linearsystem{B}{\vect{y}}</m> is consistent.  Let <m>\vect{x}\in\complex{n}</m> be one solution to this system.  Then<md>
                    <mrow>AB\vect{x}
                    &amp;=A(B\vect{x})&amp;&amp;
                        <xref ref="theorem-MMA" acro="MMA"/></mrow>
                    <mrow>&amp;=A\vect{y}&amp;&amp;
                        \vect{x}\text{ solution to }\linearsystem{B}{\vect{y}}</mrow>
                    <mrow>&amp;=\zerovector&amp;&amp;
                        \vect{y}\in\nsp{A}</mrow>
                </md>.  Since we have assumed <m>AB</m> is nonsingular, <xref ref="definition-NM" acro="NM"/> implies that <m>\vect{x}=\zerovector</m>.  Then <m>\vect{y}=B\vect{x}=B\zerovector=\zerovector</m>.</p>
                <p>When <m>AB</m> is nonsingular and <m>m=n</m> we know that the first condition, <m>\nsp{B}=\set{\zerovector}</m>, means that <m>B</m> is nonsingular (<xref ref="theorem-NMTNS" acro="NMTNS"/>).  Because <m>B</m> is nonsingular <xref ref="theorem-CSNM" acro="CSNM"/> implies that <m>\csp{B}=\complex{m}</m>.  In order to have the second condition fulfilled, <m>\csp{B}\cap\nsp{A}=\set{\zerovector}</m>, we must realize that <m>\nsp{A}=\set{\zerovector}</m>.  However, a second application of <xref ref="theorem-NMTNS" acro="NMTNS"/> shows that <m>A</m> must be nonsingular.  This reproduces <xref ref="theorem-NPNT" acro="NPNT"/>.</p>
            </solution>
        </exercise>
    </exercises>
</section>
