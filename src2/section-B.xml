<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                -->
<!--                                              -->
<!--      A First Course in Linear Algebra        -->
<!--                                              -->
<!-- Copyright (C) 2004-2017  Robert A. Beezer    -->
<!-- See the file COPYING for copying conditions. -->

<section xml:id="section-B" acro="B">
    <title>Bases</title>
    <introduction>
        <p>A basis of a vector space is one of the most useful concepts in linear algebra.  It often provides a concise, finite description of an infinite vector space.</p>
    </introduction>
    <subsection xml:id="subsection-B-B" acro="B">
        <title>Bases</title>
        <p>We now have all the tools in place to define a basis of a vector space.</p>
        <definition xml:id="definition-B" acro="B">
            <title>Basis</title>
            <idx>basis</idx>
            <statement>
                <p>Suppose <m>V</m> is a vector space.  Then a subset <m>S\subseteq V</m> is a <term>basis</term> of <m>V</m> if it is linearly independent and spans <m>V</m>.</p>
            </statement>
        </definition>
        <p>So, a basis is a linearly independent spanning set for a vector space.  The requirement that the set spans <m>V</m> insures that <m>S</m> has enough raw material to build <m>V</m>, while the linear independence requirement insures that we do not have any more raw material than we need.  As we shall see soon in <xref ref="section-D" acro="D"/>, a basis is a minimal spanning set.</p>
        <p>You may have noticed that we used the term basis for some of the titles of previous theorems (<eg/> <xref ref="theorem-BNS" acro="BNS"/>, <xref ref="theorem-BCS" acro="BCS"/>, <xref ref="theorem-BRS" acro="BRS"/>) and if you review each of these theorems you will see that their conclusions provide linearly independent spanning sets for sets that we now recognize as subspaces of <m>\complex{m}</m>.  Examples associated with these theorems include <xref ref="example-NSLIL" acro="NSLIL"/>, <xref ref="example-CSOCD" acro="CSOCD"/> and <xref ref="example-IAS" acro="IAS"/>.  As we will see, these three theorems will continue to be powerful tools, even in the setting of more general vector spaces.</p>
        <p>Furthermore, the archetypes contain an abundance of bases.  For each coefficient matrix of a system of equations, and for each archetype defined simply as a matrix, there is a basis for the null space, <em>three</em> bases for the column space, and a basis for the row space.  For this reason, our subsequent examples will concentrate on bases for vector spaces other than <m>\complex{m}</m>.</p>
        <p>Notice that <xref ref="definition-B" acro="B"/> does not preclude a vector space from having many bases, and this is the case, as hinted above by the statement that the archetypes contain three bases for the column space of a matrix.  More generally, we can grab any basis for a vector space, multiply any one basis vector by a nonzero scalar and create a slightly different set that is still a basis.  For <q>important</q> vector spaces, it will be convenient to have a collection of <q>nice</q> bases.  When a vector space has a single particularly nice basis, it is sometimes called the <term>standard basis</term> though there is nothing precise enough about this term to allow us to define it formally <mdash/> it is a question of style.  Here are some nice bases for important vector spaces.</p>
        <theorem xml:id="theorem-SUVB" acro="SUVB">
            <title>Standard Unit Vectors are a Basis</title>
            <idx>
                <h>unit vectors</h>
                <h>basis</h>
            </idx>
            <statement>
                <p>The set of standard unit vectors for <m>\complex{m}</m> (<xref ref="definition-SUV" acro="SUV"/>), <m>B=\setparts{\vect{e}_i}{1\leq i\leq m}</m> is a basis for the vector space <m>\complex{m}</m>.</p>
            </statement>
            <proof>
                <p>We must show that the set <m>B</m> is both linearly independent and a spanning set for <m>\complex{m}</m>.  First, the vectors in <m>B</m> are, by <xref ref="definition-SUV" acro="SUV"/>, the columns of the identity matrix, which we know is nonsingular (since it row-reduces to the identity matrix, <xref ref="theorem-NMRRI" acro="NMRRI"/>).  And the columns of a nonsingular matrix are linearly independent by <xref ref="theorem-NMLIC" acro="NMLIC"/>.</p>
                <p>Suppose we grab an arbitrary vector from <m>\complex{m}</m>, say<me>\vect{v}=\colvector{v_1\\v_2\\v_3\\\vdots\\v_m}</me>.</p>
                <p>Can we write <m>\vect{v}</m> as a linear combination of the vectors in <m>B</m>?  Yes, and quite simply.<md>
                    <mrow>\colvector{v_1\\v_2\\v_3\\\vdots\\v_m}&amp;=
                    v_1\colvector{1\\0\\0\\\vdots\\0}+
                    v_2\colvector{0\\1\\0\\\vdots\\0}+
                    v_3\colvector{0\\0\\1\\\vdots\\0}+
                    \cdots+
                    v_m\colvector{0\\0\\0\\\vdots\\1}</mrow>
                    <mrow>\vect{v}&amp;=v_1\vect{e}_1+v_2\vect{e}_2+v_3\vect{e}_3+\cdots+v_m\vect{e}_m</mrow>
                </md></p>
                <p>This shows that <m>\complex{m}\subseteq\spn{B}</m>, which is sufficient to show that <m>B</m> is a spanning set for <m>\complex{m}</m>.</p>
            </proof>
        </theorem>
        <example xml:id="example-BP" acro="BP">
            <title>Bases for <m>P_n</m></title>
            <idx>
                <h>basis</h>
                <h>polynomials</h>
            </idx>
            <p>The vector space of polynomials with degree at most <m>n</m>, <m>P_n</m>, has the basis<me>B=\set{1,\,x,\,x^2,\,x^3,\,\ldots,\,x^n}</me>.</p>
            <p>Another nice basis for <m>P_n</m> is<me>C=\set{1,\,1+x,\,1+x+x^2,\,1+x+x^2+x^3,\,\ldots,\,1+x+x^2+x^3+\cdots+x^n}</me>.</p>
            <p>Checking that each of <m>B</m> and <m>C</m> is a linearly independent spanning set are good exercises.</p>
        </example>
        <example xml:id="example-BM" acro="BM">
            <title>A basis for the vector space of matrices</title>
            <idx>
                <h>basis</h>
                <h>matrices</h>
            </idx>
            <p>In the vector space <m>M_{mn}</m> of matrices (<xref ref="example-VSM" acro="VSM"/>)  define the matrices <m>B_{k\ell}</m>, <m>1\leq k\leq m</m>, <m>1\leq\ell\leq n</m> by<me>\matrixentry{B_{k\ell}}{ij}=\begin{cases}
            1&amp;\text{if }k=i,\,\ell=j\\
            0&amp;\text{otherwise}
            \end{cases}</me>.</p>
            <p>So these matrices have entries that are all zeros, with the exception of a lone entry that is one.  The set of all <m>mn</m> of them,<me>B=\setparts{B_{k\ell}}{1\leq k\leq m,\ 1\leq\ell\leq n}</me>forms a basis for <m>M_{mn}</m>.  See <xref ref="exercise-B-M20" acro="B.M20"/>.</p>
        </example>
        <p>The bases described above will often be convenient ones to work with.  However a basis does not have to obviously look like a basis.</p>
        <example xml:id="example-BSP4" acro="BSP4">
            <idx>
            <title>A basis for a subspace of <m>P_4</m></title>
                <h>basis</h>
                <h>polynomials</h>
            </idx>
            <p>In <xref ref="example-SSP4" acro="SSP4"/> we showed that<me>S=\set{x-2,\,x^2-4x+4,\,x^3-6x^2+12x-8,\,x^4-8x^3+24x^2-32x+16}</me>is a spanning set for <m>W=\setparts{p(x)}{p\in P_4,\ p(2)=0}</m>.  We will now show that <m>S</m> is also linearly independent in <m>W</m>.  Begin with a relation of linear dependence,<md>
                <mrow>0+0x&amp;+0x^2+0x^3+0x^4</mrow>
                <mrow>&amp;=\alpha_1\left(x-2\right)+\alpha_2\left(x^2-4x+4\right)+\alpha_3\left(x^3-6x^2+12x-8\right)</mrow>
                <mrow>&amp;\quad\quad +\alpha_4\left(x^4-8x^3+24x^2-32x+16\right)</mrow>
                <mrow>&amp;=\alpha_4x^4+
                \left(\alpha_3-8\alpha_4\right)x^3+
                \left(\alpha_2-6\alpha_3+24\alpha_4\right)x^2</mrow>
                <mrow>&amp;\quad\quad +
                \left(\alpha_1-4\alpha_2+12\alpha_3-32\alpha_4\right)x+
                \left(-2\alpha_1+4\alpha_2-8\alpha_3+16\alpha_4\right)</mrow>
            </md>.</p>
            <p>Equating coefficients (vector equality in <m>P_4</m>) gives the homogeneous system of five equations in four variables,<md>
                <mrow>\alpha_4&amp;=0</mrow>
                <mrow>\alpha_3-8\alpha_4&amp;=0</mrow>
                <mrow>\alpha_2-6\alpha_3+24\alpha_4&amp;=0</mrow>
                <mrow>\alpha_1-4\alpha_2+12\alpha_3-32\alpha_4&amp;=0</mrow>
                <mrow>-2\alpha_1+4\alpha_2-8\alpha_3+16\alpha_4&amp;=0</mrow>
            </md>.</p>
            <p>We form the coefficient matrix, and row-reduce to obtain a matrix in reduced row-echelon form<me>\begin{bmatrix}
            \leading{1}&amp;0&amp;0&amp;0\\
            0&amp;\leading{1}&amp;0&amp;0\\
            0&amp;0&amp;\leading{1}&amp;0\\
            0&amp;0&amp;0&amp;\leading{1}\\
            0&amp;0&amp;0&amp;0
            \end{bmatrix}</me>.</p>
            <p>With <em>only</em> the trivial solution to this homogeneous system, we conclude that only scalars that will form a relation of linear dependence are the trivial ones, and therefore the set <m>S</m> is linearly independent (<xref ref="definition-LI" acro="LI"/>).  Finally, <m>S</m> has earned the right to be called a basis for <m>W</m> (<xref ref="definition-B" acro="B"/>).</p>
        </example>
        <example xml:id="example-BSM22" acro="BSM22">
            <title>A basis for a subspace of <m>M_{22}</m></title>
            <idx>
                <h>basis</h>
                <h>matrices</h>
            </idx>
            <p>In <xref ref="example-SSM22" acro="SSM22"/> we discovered that<me>Q=\set{
            \begin{bmatrix}-3&amp;1\\0&amp;0\end{bmatrix},\,
            \begin{bmatrix}1&amp;0\\-4&amp;1\end{bmatrix}
            }</me>is a spanning set for the subspace<me>Z=\setparts{\begin{bmatrix}a&amp;b\\c&amp;d\end{bmatrix}}{a+3b-c-5d=0,\ -2a-6b+3c+14d=0}</me>of the vector space of all <m>2\times 2</m> matrices, <m>M_{22}</m>.  If we can also determine that <m>Q</m> is linearly independent in <m>Z</m> (or in <m>M_{22}</m>), then it will qualify as a basis for <m>Z</m>.</p>
            <p>Let us begin with a relation of linear dependence.<md>
                <mrow>\begin{bmatrix}0&amp;0\\0&amp;0\end{bmatrix}
                &amp;=
                \alpha_1\begin{bmatrix}-3&amp;1\\0&amp;0\end{bmatrix}+
                \alpha_2\begin{bmatrix}1&amp;0\\-4&amp;1\end{bmatrix}</mrow>
                <mrow>&amp;=\begin{bmatrix}
                -3\alpha_1 +\alpha_2  &amp; \alpha_1\\
                -4\alpha_2 &amp; \alpha_2
                \end{bmatrix}</mrow>
            </md></p>
            <p>Using our definition of matrix equality (<xref ref="definition-ME" acro="ME"/>) we equate entries and get a homogeneous system of four equations in two variables,<md>
                <mrow>-3\alpha_1 +\alpha_2&amp;=0</mrow>
                <mrow>\alpha_1&amp;=0</mrow>
                <mrow>-4\alpha_2&amp;=0</mrow>
                <mrow>\alpha_2&amp;=0</mrow>
            </md>.</p>
            <p>We could row-reduce the coefficient matrix of this homogeneous system, but it is not necessary.  The second and fourth equations tell us that <m>\alpha_1=0</m>, <m>\alpha_2=0</m> is the <em>only</em> solution to this homogeneous system.  This qualifies the set <m>Q</m> as being linearly independent, since the only relation of linear dependence is trivial (<xref ref="definition-LI" acro="LI"/>).  Therefore <m>Q</m> is a basis for <m>Z</m> (<xref ref="definition-B" acro="B"/>).</p>
        </example>
        <example xml:id="example-BC" acro="BC">
            <title>Basis for the crazy vector space</title>
            <idx>
                <h>basis</h>
                <h>crazy vector space</h>
            </idx>
            <p>In <xref ref="example-LIC" acro="LIC"/> and <xref ref="example-SSC" acro="SSC"/> we determined that the set <m>R=\set{(1,\,0),\,(6,\,3)}</m> from the crazy vector space, <m>C</m> (<xref ref="example-CVS" acro="CVS"/>), is linearly independent and is a spanning set for <m>C</m>.  By <xref ref="definition-B" acro="B"/> we see that <m>R</m> is a basis for <m>C</m>.</p>
        </example>
        <p>We have seen that several of the sets associated with a matrix are subspaces of vector spaces of column vectors.  Specifically these are the null space (<xref ref="theorem-NSMS" acro="NSMS"/>), column space (<xref ref="theorem-CSMS" acro="CSMS"/>), row space  (<xref ref="theorem-RSMS" acro="RSMS"/>) and left null space (<xref ref="theorem-LNSMS" acro="LNSMS"/>).  As subspaces they are vector spaces (<xref ref="definition-S" acro="S"/>) and it is natural to ask about bases for these vector spaces.  <xref ref="theorem-BNS" acro="BNS"/>, <xref ref="theorem-BCS" acro="BCS"/>, <xref ref="theorem-BRS" acro="BRS"/> each have conclusions that provide linearly independent spanning sets for (respectively) the null space, column space, and row space.  Notice that each of these theorems contains the word <q>basis</q> in its title, even though we did not know the precise meaning of the word at the time.  To find a basis for a left null space we can use the definition of this subspace as a null space (<xref ref="definition-LNS" acro="LNS"/>) and  apply <xref ref="theorem-BNS" acro="BNS"/>.  Or <xref ref="theorem-FS" acro="FS"/> tells us that the left null space can be expressed as a row space and we can then use <xref ref="theorem-BRS" acro="BRS"/>.</p>
        <p><xref ref="theorem-BS" acro="BS"/> is another early result that provides a linearly independent spanning set (<ie/> a basis) as its conclusion.  If a vector space of column vectors can be expressed as a span of a set of column vectors, then <xref ref="theorem-BS" acro="BS"/> can be employed in a straightforward manner to quickly yield a basis.</p>
    </subsection>
    <subsection xml:id="subsection-B-BSCV" acro="BSCV">
        <title>Bases for Spans of Column Vectors</title>
        <p>We have seen several examples of bases in different vector spaces.  In this subsection, and the next (<xref ref="subsection-B-BNM" acro="B.BNM"/>), we will consider building bases for <m>\complex{m}</m> and its subspaces.</p>
        <p>Suppose we have a subspace of <m>\complex{m}</m> that is expressed as the span of a set of vectors, <m>S</m>, and <m>S</m> is not necessarily linearly independent, or perhaps not very attractive.  <xref ref="theorem-REMRS" acro="REMRS"/> says that row-equivalent matrices have identical row spaces, while <xref ref="theorem-BRS" acro="BRS"/> says the nonzero rows of a matrix in reduced row-echelon form are a basis for the row space.  These theorems together give us a great computational tool for quickly finding a basis for a subspace that is expressed originally as a span.</p>
        <example xml:id="example-RSB" acro="RSB">
            <title>Row space basis</title>
            <idx>
                <h>row space</h>
                <h>basis</h>
            </idx>
            <p>When we first defined the span of a set of column vectors, in <xref ref="example-SCAD" acro="SCAD"/> we looked at the set<me>W=\spn{\set{
            \colvector{2\\-3\\1},\,
            \colvector{1\\4\\1},\,
            \colvector{7\\-5\\4},\,
            \colvector{-7\\-6\\-5}
            }}</me>with an eye towards realizing <m>W</m> as the span of a smaller set.  By building relations of linear dependence (though we did not know them by that name then) we were able to remove two vectors and write <m>W</m> as the span of the other two vectors.  These two remaining vectors formed a linearly independent set, even though we did not know that at the time.</p>
            <p>Now we know that <m>W</m> is a subspace and must have a basis.  Consider the matrix, <m>C</m>, whose rows are the vectors in the spanning set for <m>W</m>,<me>C=\begin{bmatrix}
            2 &amp; -3 &amp; 1\\
            1 &amp; 4 &amp; 1\\
            7 &amp; -5 &amp; 4\\
            -7 &amp; -6 &amp; -5
            \end{bmatrix}</me>.</p>
            <p>Then, by <xref ref="definition-RSM" acro="RSM"/>, the row space of <m>C</m> will be <m>W</m>, <m>\rsp{C}=W</m>.<xref ref="theorem-BRS" acro="BRS"/> tells us that if we row-reduce <m>C</m>, the nonzero rows of the row-equivalent matrix in reduced row-echelon form will be a basis for <m>\rsp{C}</m>, and hence a basis for <m>W</m>.  Let us do it <mdash/> <m>C</m> row-reduces to<me>\begin{bmatrix}
            \leading{1} &amp; 0 &amp; \frac{7}{11}\\
            0 &amp; \leading{1} &amp; \frac{1}{11}\\
            0 &amp; 0 &amp; 0\\
            0 &amp; 0 &amp; 0
            \end{bmatrix}</me>.</p>
            <p>If we convert the two nonzero rows to column vectors then we have a basis,<me>B=\set{\colvector{1\\0\\\frac{7}{11}},\,\colvector{0\\1\\\frac{1}{11}}}</me>and<me>W=\spn{\set{\colvector{1\\0\\\frac{7}{11}},\,\colvector{0\\1\\\frac{1}{11}}}}</me>.</p>
            <p>For aesthetic reasons, we might wish to multiply each vector in <m>B</m> by <m>11</m>, which will not change the spanning or linear independence properties of <m>B</m> as a basis.  Then we can also write<me>W=\spn{\set{\colvector{11\\0\\7},\,\colvector{0\\11\\1}}}</me>.</p>
        </example>
        <p><xref ref="example-IAS" acro="IAS"/> provides another example of this flavor, though now we can notice that <m>X</m> is a subspace, and that the resulting set of three vectors is a basis.  This is such a powerful technique that we should do one more example.</p>
        <example xml:id="example-RS" acro="RS">
            <title>Reducing a span</title>
            <idx>
                <h>span</h>
                <h>reduction</h>
            </idx>
            <p>In <xref ref="example-RSC5" acro="RSC5"/> we began with a set of <m>n=4</m> vectors from <m>\complex{5}</m>,<me>R=\set{\vect{v}_1,\,\vect{v}_2,\,\vect{v}_3,\,\vect{v}_4}
            =
            \set{
            \colvector{1\\2\\-1\\3\\2},\,
            \colvector{2\\1\\3\\1\\2},\,
            \colvector{0\\-7\\6\\-11\\-2},\,
            \colvector{4\\1\\2\\1\\6}
            }</me>and defined <m>V=\spn{R}</m>.  Our goal in that problem was to find a relation of linear dependence on the vectors in <m>R</m>, solve the resulting equation for one of the vectors, and re-express <m>V</m> as the span of a set of three vectors.</p>
            <p>Here is another way to accomplish something similar.  The row space of the matrix<me>A=\begin{bmatrix}
            1 &amp; 2 &amp; -1 &amp; 3 &amp; 2\\
            2 &amp; 1 &amp; 3 &amp; 1 &amp; 2\\
            0 &amp; -7 &amp; 6 &amp; -11 &amp; -2\\
            4 &amp; 1 &amp; 2 &amp; 1 &amp; 6
            \end{bmatrix}</me>is equal to <m>\spn{R}</m>.  By <xref ref="theorem-BRS" acro="BRS"/> we can row-reduce this matrix, ignore any zero rows, and use the nonzero rows as column vectors that are a basis for the row space of <m>A</m>.  Row-reducing <m>A</m> creates the matrix<me>\begin{bmatrix}
            1 &amp; 0 &amp; 0 &amp; -\frac{1}{17} &amp; \frac{30}{17}\\
            0 &amp; 1 &amp; 0 &amp; \frac{25}{17} &amp; -\frac{2}{17}\\
            0 &amp; 0 &amp; 1 &amp; -\frac{2}{17} &amp; -\frac{8}{17}\\
            0 &amp; 0 &amp; 0 &amp; 0 &amp; 0
            \end{bmatrix}</me>.</p>
            <p>So<me>\set{
            \colvector{1\\0\\0\\-\frac{1}{17}\\\frac{30}{17}},\,
            \colvector{0\\1\\0\\\frac{25}{17}\\-\frac{2}{17}},\,
            \colvector{0\\0\\1\\-\frac{2}{17}\\-\frac{8}{17}}
            }</me>is a basis for <m>V</m>.  Our theorem tells us this is a basis, there is no need to verify that the subspace spanned by three vectors (rather than four) is the identical subspace, and there is no need to verify that we have reached the limit in reducing the set, since the set of three vectors is guaranteed to be linearly independent.</p>
        </example>
        <computation xml:id="sage-B" acro="B">
            <title>Bases</title>
            <idx>bases</idx>
            <p>Every vector space in Sage has a basis <mdash/> you can obtain this with the vector space method <c>.basis()</c>, and the result is a list of vectors.  Another method for a vector space is <c>.basis_matrix()</c> which outputs a matrix whose rows are the vectors of a basis.  Sometimes one form is more convenient than the other, but notice that the description of a vector space chooses to print the basis matrix (since its display is just a bit easier to read).  A vector space typically has many bases (infinitely many), so which one does Sage use?  You will notice that the basis matrices displayed are in reduced row-echelon form <mdash/> this is the defining property of the basis chosen by Sage.</p>
            <p>Here is <xref ref="example-RSB" acro="RSB"/> again as an example of how bases are provided in Sage.</p>
            <sage xml:id="sagecell-B-1">
                <input>
                V = QQ^3
                v1 = vector(QQ, [ 2, -3,  1])
                v2 = vector(QQ, [ 1,  4,  1])
                v3 = vector(QQ, [ 7, -5,  4])
                v4 = vector(QQ, [-7, -6, -5])
                W = V.span([v1, v2, v3, v4])
                W
                </input>
                <output>
                Vector space of degree 3 and dimension 2 over Rational Field
                Basis matrix:
                [   1    0 7/11]
                [   0    1 1/11]
                </output>
            </sage>
            <sage xml:id="sagecell-B-2">
                <input>
                W.basis()
                </input>
                <output>
                [
                (1, 0, 7/11),
                (0, 1, 1/11)
                ]
                </output>
            </sage>
            <sage xml:id="sagecell-B-3">
                <input>
                W.basis_matrix()
                </input>
                <output>
                [   1    0 7/11]
                [   0    1 1/11]
                </output>
            </sage>
        </computation>
        <computation xml:id="sage-SUTH0" acro="SUTH0">
            <title>Sage Under The Hood, Round 0</title>
            <idx>
                <h>sage under the hood</h>
                <h>round 0</h>
            </idx>
            <p>Or perhaps, <q>under the bonnet</q> if you learned your English in the Commonwealth.  This is the first in a series that aims to explain how our knowledge of linear algebra <em>theory</em> helps us understand the design, construction and informed use of Sage.</p>
            <p>How does Sage determine if two vector spaces are equal?  Especially since these are infinite sets?  One approach would be to take a spanning set for the first vector space (maybe a minimal spanning set), and ask if each element of the spanning set is an element of the second vector space.  If so, the first vector space is a subset of the second.  Then we could turn it around, and determine if the second vector space is a subset of the first.  By <xref ref="definition-SE" acro="SE"/>, the two vector spaces would be equal if both subset tests succeeded.</p>
            <p>However, each time we would test if an element of a spanning set lives in a second vector space, we would need to solve a linear system.  So for two large vector spaces, this could take a noticeable amount of time.  There is a better way, made possible by exploiting two important theorems.</p>
            <p>For every vector space, Sage creates a basis that uniquely identifies the vector space.  We could call this a <term>canonical basis</term>.  By <xref ref="theorem-REMRS" acro="REMRS"/> we can span the row space of a matrix by the rows of any row-equivalent matrix.  So if we begin with a vector space described by any basis (or any spanning set, for that matter), we can make a matrix with these rows as vectors, and the vector space is now the row space of the matrix.  Of all the possible row-equivalent matrices, which would you pick?  Of course, the reduced row-echelon version is useful, and here it is critical to realize this version is unique (<xref ref="theorem-RREFU" acro="RREFU"/>).</p>
            <p>So for every vector space, Sage takes a spanning set, makes its vectors the rows of a matrix, row-reduces the matrix and tosses out the zero rows.  The result is what Sage calls an <term>echelonized basis</term>.  Now, two vector spaces are equal if, and only if, they have equal <term>echelonized basis matrices</term>.  It takes some computation to form the echelonized basis, but once built, the comparison of two echelonized bases can proceed very quickly by perhaps just comparing entries of the echelonized basis matrices.</p>
            <p>You might create a vector space with a basis you prefer (a <term>user basis</term>), but Sage always has an echelonized basis at hand.  If you do not specify some alternate basis, this is the basis Sage will create and provide for you.  We can now continue a discussion we began back in Sage<nbsp/><xref ref="sage-SSNS" acro="SSNS" text="global"/>.  We have consistently used the <c>basis='pivot'</c> keyword when we construct null spaces.  This is because we initially prefer to see the basis described in <xref ref="theorem-BNS" acro="BNS"/>, rather than Sage's default basis, the echelonized version.  But the echelonized version is always present and available.</p>
            <sage xml:id="sagecell-SUTH0-1">
                <input>
                A = matrix(QQ, [[14, -42, -2, -44, -42, 100, -18],
                                [-40, 120, -6, 129, 135, -304, 28],
                                [11, -33, 0, -35, -35, 81, -11],
                                [-21, 63, -4, 68, 72, -161, 13],
                                [-4, 12, -1, 13, 14, -31, 2]])
                K = A.right_kernel(basis='pivot')
                K.basis_matrix()
                </input>
                <output>
                [ 3  1  0  0  0  0  0]
                [ 0  0  1 -1  1  0  0]
                [-1  0 -1  2  0  1  0]
                [ 1  0 -2  0  0  0  1]
                </output>
            </sage>
            <sage xml:id="sagecell-SUTH0-2">
                <input>
                K.echelonized_basis_matrix()
                </input>
                <output>
                [ 1  0  0  0 -4 -2 -1]
                [ 0  1  0  0 12  6  3]
                [ 0  0  1  0 -2 -1 -1]
                [ 0  0  0  1 -3 -1 -1]
                </output>
            </sage>
        </computation>
    </subsection>
    <subsection xml:id="subsection-B-BNM" acro="BNM">
        <title>Bases and Nonsingular Matrices</title>
        <p>A quick source of diverse bases for <m>\complex{m}</m> is the set of columns of a nonsingular matrix.</p>
        <theorem xml:id="theorem-CNMB" acro="CNMB">
            <title>Columns of Nonsingular Matrix are a Basis</title>
            <idx>
                <h>nonsingular</h>
                <h> columns as basis</h>
            </idx>
            <statement>
                <p>Suppose that <m>A</m> is a square matrix of size <m>m</m>.  Then the columns of <m>A</m> are a basis of <m>\complex{m}</m> if and only if <m>A</m> is nonsingular.</p>
            </statement>
            <proof>
                <case direction="forward">
                    <p>Suppose that the columns of <m>A</m> are a basis for <m>\complex{m}</m>.  Then <xref ref="definition-B" acro="B"/> says the set of columns is linearly independent.  <xref ref="theorem-NMLIC" acro="NMLIC"/> then says that <m>A</m> is nonsingular.</p>
                </case>
                <case direction="backward">
                    <p>Suppose that <m>A</m> is nonsingular.  Then by <xref ref="theorem-NMLIC" acro="NMLIC"/> this set of columns is linearly independent.  <xref ref="theorem-CSNM" acro="CSNM"/> says that for a nonsingular matrix, <m>\csp{A}=\complex{m}</m>.  This is equivalent to saying that the columns of <m>A</m> are a spanning set for the vector space <m>\complex{m}</m>.  As a linearly independent spanning set, the columns of <m>A</m> qualify as a basis for <m>\complex{m}</m> (<xref ref="definition-B" acro="B"/>).</p>
                </case>
            </proof>
        </theorem>
        <example xml:id="example-CABAK" acro="CABAK">
            <title>Columns as Basis, Archetype K</title>
            <idx>
                <h>basis</h>
                <h>columns nonsingular matrix</h>
            </idx>
            <!-- Archetype K, Part matrixdefn -->
            <!-- Archetype K, Part rangebasisoriginal -->
            <p>Archetype<nbsp/><xref ref="archetype-K" acro="K" text="global"/> is the <m>5\times 5</m> matrix<me>K=\begin{bmatrix}
            10 &amp; 18 &amp; 24 &amp; 24 &amp; -12 \\
            12 &amp; -2 &amp;  -6 &amp; 0 &amp; -18 \\
            -30 &amp;  -21 &amp; -23 &amp;  -30 &amp; 39 \\
            27 &amp; 30 &amp;  36 &amp; 37 &amp;  -30 \\
            18 &amp; 24 &amp; 30 &amp;  30 &amp; -20
            \end{bmatrix}</me>which is row-equivalent to the <m>5\times 5</m> identity matrix <m>I_5</m>.  So by <xref ref="theorem-NMRRI" acro="NMRRI"/>, <m>K</m> is nonsingular.  Then <xref ref="theorem-CNMB" acro="CNMB"/> says the set<me>\set{\colvector{10\\12\\-30\\27\\18},\,\colvector{18\\-2\\-21\\30\\24},\,\colvector{24\\-6\\-23\\36\\30},\,\colvector{24\\0\\-30\\37\\30},\,\colvector{-12\\-18\\39\\-30\\-20}}</me>is a (novel) basis of <m>\complex{5}</m>.</p>
        </example>
        <p>Perhaps we should view the fact that the standard unit vectors are a basis (<xref ref="theorem-SUVB" acro="SUVB"/>) as just a simple corollary of <xref ref="theorem-CNMB" acro="CNMB"/>?  (See Proof Technique<nbsp/><xref ref="technique-LC" acro="LC" text="global"/>.)</p>
        <p>With a new equivalence for a nonsingular matrix, we can update our list of equivalences.</p>
        <theorem xml:id="theorem-NME5" acro="NME5">
            <title>Nonsingular Matrix Equivalences, Round 5</title>
            <idx>
                <h>nonsingular matrix</h>
                <h>equivalences</h>
            </idx>
            <statement>
                <p>Suppose that <m>A</m> is a square matrix of size <m>n</m>.  The following are equivalent.<ol>
                    <li><m>A</m> is nonsingular.</li>
                    <li><m>A</m> row-reduces to the identity matrix.</li>
                    <li>The null space of <m>A</m> contains only the zero vector, <m>\nsp{A}=\set{\zerovector}</m>.</li>
                    <li>The linear system <m>\linearsystem{A}{\vect{b}}</m> has a unique solution for every possible choice of <m>\vect{b}</m>.</li>
                    <li>The columns of <m>A</m> are a linearly independent set.</li>
                    <li><m>A</m> is invertible.</li>
                    <li>The column space of <m>A</m> is <m>\complex{n}</m>, <m>\csp{A}=\complex{n}</m>.</li>
                    <li>The columns of <m>A</m> are a basis for <m>\complex{n}</m>.</li>
                </ol></p>
            </statement>
            <proof>
                <p>With a new equivalence for a nonsingular matrix in <xref ref="theorem-CNMB" acro="CNMB"/> we can expand <xref ref="theorem-NME4" acro="NME4"/>.</p>
            </proof>
        </theorem>
        <computation xml:id="sage-NME5" acro="NME5">
            <title>Nonsingular Matrix Equivalences, Round 5</title>
            <idx>
                <h>nonsingular matrix equivalences</h>
                <h>round 5</h>
            </idx>
            <p>We can easily illustrate our latest equivalence for nonsingular matrices.</p>
            <sage xml:id="sagecell-NME5-1">
                <input>
                A = matrix(QQ, [[ 2,  3, -3,  2,  8, -4],
                                [ 3,  4, -4,  4,  8,  1],
                                [-2, -2,  3, -3, -2, -7],
                                [ 0,  1, -1,  2,  3,  4],
                                [ 2,  1,  0,  1, -4,  4],
                                [ 1,  2, -2,  1,  7, -5]])
                not A.is_singular()
                </input>
                <output>
                True
                </output>
            </sage>
            <sage xml:id="sagecell-NME5-2">
                <input>
                V = QQ^6
                cols = A.columns()
                V == V.span(cols)
                </input>
                <output>
                True
                </output>
            </sage>
            <sage xml:id="sagecell-NME5-3">
                <input>
                V.linear_dependence(cols) == []
                </input>
                <output>
                True
                </output>
            </sage>
        </computation>
    </subsection>
    <subsection xml:id="subsection-B-OBC" acro="OBC">
        <title>Orthonormal Bases and Coordinates</title>
        <p>We learned about orthogonal sets of vectors in <m>\complex{m}</m> back in <xref ref="section-O" acro="O"/>, and we also learned that orthogonal sets are automatically linearly independent (<xref ref="theorem-OSLI" acro="OSLI"/>).  When an orthogonal set also spans a subspace of <m>\complex{m}</m>, then the set is a basis.  And when the set is orthonormal, then the set is an incredibly nice basis.  We will back up this claim with a theorem, but first consider how you might manufacture such a set.</p>
        <p>Suppose that <m>W</m> is a subspace of <m>\complex{m}</m> with basis <m>B</m>.  Then <m>B</m> spans <m>W</m> and is a linearly independent set of nonzero vectors.  We can apply the Gram-Schmidt Procedure (<xref ref="theorem-GSP" acro="GSP"/>) and obtain a linearly independent set <m>T</m> such that <m>\spn{T}=\spn{B}=W</m> and <m>T</m> is orthogonal.  In other words, <m>T</m> is a basis for <m>W</m>, and is an orthogonal set.  By scaling each vector of <m>T</m> to norm 1, we can convert <m>T</m> into an orthonormal set, without destroying the properties that make it a basis of <m>W</m>.  In short, we can convert any basis into an orthonormal basis.  <xref ref="example-GSTV" acro="GSTV"/>, followed by <xref ref="example-ONTV" acro="ONTV"/>, illustrates this process.</p>
        <p>Unitary matrices (<xref ref="definition-UM" acro="UM"/>) are another good source of orthonormal bases (and vice versa).  Suppose that <m>Q</m> is a unitary matrix of size <m>n</m>.  Then the <m>n</m> columns of <m>Q</m> form an orthonormal set (<xref ref="theorem-CUMOS" acro="CUMOS"/>) that is therefore linearly independent (<xref ref="theorem-OSLI" acro="OSLI"/>).  Since <m>Q</m> is invertible (<xref ref="theorem-UMI" acro="UMI"/>), we know <m>Q</m> is nonsingular (<xref ref="theorem-NI" acro="NI"/>), and then the columns of <m>Q</m> span <m>\complex{n}</m> (<xref ref="theorem-CSNM" acro="CSNM"/>).  So the columns of a unitary matrix of size <m>n</m> are an orthonormal basis for <m>\complex{n}</m>.</p>
        <p>Why all the fuss about orthonormal bases?  <xref ref="theorem-VRRB" acro="VRRB"/> told us that any vector in a vector space could be written, uniquely, as a linear combination of basis vectors.  For an orthonormal basis, finding the scalars for this linear combination is extremely easy, and this is the content of the next theorem.  Furthermore, with vectors written this way (as linear combinations of the elements of an orthonormal set) certain computations and analysis become much easier.  Here is the promised theorem.</p>
        <theorem xml:id="theorem-COB" acro="COB">
            <title>Coordinates and Orthonormal Bases</title>
            <idx>
                <h>coordinates</h>
                <h>orthonormal basis</h>
            </idx>
            <statement>
                <p>Suppose that <m>B=\set{\vectorlist{v}{p}}</m> is an orthonormal basis of the subspace <m>W</m> of <m>\complex{m}</m>.  For any <m>\vect{w}\in W</m>,<me>\vect{w}=
                \innerproduct{\vect{v}_1}{\vect{w}}\vect{v}_1+
                \innerproduct{\vect{v}_2}{\vect{w}}\vect{v}_2+
                \innerproduct{\vect{v}_3}{\vect{w}}\vect{v}_3+
                \cdots+
                \innerproduct{\vect{v}_p}{\vect{w}}\vect{v}_p</me>.</p>
            </statement>
            <proof>
                <p>Because <m>B</m> is a basis of <m>W</m>, <xref ref="theorem-VRRB" acro="VRRB"/> tells us that we can write <m>\vect{w}</m> uniquely as a linear combination of the vectors in <m>B</m>.  So it is not this aspect of the conclusion that makes this theorem interesting.  What is interesting is that the particular scalars are so easy to compute.  No need to solve big systems of equations <mdash/> just do an inner product of <m>\vect{w}</m> with <m>\vect{v}_i</m> to arrive at the coefficient of <m>\vect{v}_i</m> in the linear combination.</p>
                <p>So begin the proof by writing <m>\vect{w}</m> as a linear combination of the vectors in <m>B</m>, using unknown scalars,<me>\vect{w}=\lincombo{a}{v}{p}</me>and compute,<md>
                    <mrow>\innerproduct{\vect{v}_i}{\vect{w}}
                    &amp;=\innerproduct{\vect{v}_i}{\sum_{k=1}^{p}a_k\vect{v}_k}&amp;&amp;
                        <xref ref="theorem-VRRB" acro="VRRB"/></mrow>
                    <mrow>&amp;=\sum_{k=1}^{p}\innerproduct{\vect{v}_i}{a_k\vect{v}_k}&amp;&amp;
                        <xref ref="theorem-IPVA" acro="IPVA"/></mrow>
                    <mrow>&amp;=\sum_{k=1}^{p}a_k\innerproduct{\vect{v}_i}{\vect{v}_k}&amp;&amp;
                        <xref ref="theorem-IPSM" acro="IPSM"/></mrow>
                    <mrow>&amp;=a_i\innerproduct{\vect{v}_i}{\vect{v}_i}+
                    \sum_{\substack{k=1\\k\neq i}}^{p}a_k\innerproduct{\vect{v}_i}{\vect{v}_k}&amp;&amp;
                        <xref ref="property-C" acro="C"/></mrow>
                    <mrow>&amp;=a_i(1)+\sum_{\substack{k=1\\k\neq i}}^{p}a_k(0)&amp;&amp;
                        <xref ref="definition-ONS" acro="ONS"/></mrow>
                    <mrow>&amp;=a_i</mrow>
                </md>.</p>
                <p>So the (unique) scalars for the linear combination are indeed the inner products advertised in the conclusion of the theorem's statement.</p>
            </proof>
        </theorem>
        <example xml:id="example-CROB4" acro="CROB4">
            <title>Coordinatization relative to an orthonormal basis, <m>\complex{4}</m></title>
            <idx>
                <h>coordinatization</h>
                <h>orthonormal basis</h>
            </idx>
            <p>The set<me>\set{\vect{x}_1,\,\vect{x}_2,\,\vect{x}_3,\,\vect{x}_4}=
            \set{
            \colvector{1+i\\1\\1-i\\i},\,
            \colvector{1+5i\\6+5i\\-7-i\\1-6i},\,
            \colvector{-7+34i\\-8-23i\\-10+22i\\30+13i},\,
            \colvector{-2-4i\\6+i\\4+3i\\6-i}
            }</me>was proposed, and partially verified, as an orthogonal set in <xref ref="example-AOS" acro="AOS"/>.  Let us scale each vector to norm 1, so as to form an orthonormal set in <m>\complex{4}</m>.  Then by <xref ref="theorem-OSLI" acro="OSLI"/> the set will be linearly independent, and by <xref ref="theorem-NME5" acro="NME5"/> the set will be a basis for <m>\complex{4}</m>.  So, once scaled to norm 1, the adjusted set will be an orthonormal basis of <m>\complex{4}</m>.  The norms are<md>
                <mrow>\norm{\vect{x}_1}=\sqrt{6}&amp;&amp;
                \norm{\vect{x}_2}=\sqrt{174}&amp;&amp;
                \norm{\vect{x}_3}=\sqrt{3451}&amp;&amp;
                \norm{\vect{x}_4}=\sqrt{119}</mrow>
            </md>.</p>
            <p>So an orthonormal basis is<md>
                <mrow>B&amp;=
                \set{\vect{v}_1,\,\vect{v}_2,\,\vect{v}_3,\,\vect{v}_4}</mrow>
                <mrow>&amp;=\set{
                \frac{1}{\sqrt{6}}\colvector{1+i\\1\\1-i\\i},\,
                \frac{1}{\sqrt{174}}\colvector{1+5i\\6+5i\\-7-i\\1-6i},\,
                \frac{1}{\sqrt{3451}}\colvector{-7+34i\\-8-23i\\-10+22i\\30+13i},\,
                \frac{1}{\sqrt{119}}\colvector{-2-4i\\6+i\\4+3i\\6-i}
                }</mrow>
            </md>.</p>
            <p>Now, to illustrate <xref ref="theorem-COB" acro="COB"/>, choose any vector from <m>\complex{4}</m>, say <m>\vect{w}=\colvector{2\\-3\\1\\4}</m>, and compute<md>
                <mrow>\innerproduct{\vect{v}_1}{\vect{w}}&amp;=\frac{-5i}{\sqrt{6}}&amp;
                \innerproduct{\vect{v}_2}{\vect{w}}&amp;=\frac{-19+30i}{\sqrt{174}}</mrow>
                <mrow>\innerproduct{\vect{v}_3}{\vect{w}}&amp;=\frac{120-211i}{\sqrt{3451}}&amp;
                \innerproduct{\vect{v}_4}{\vect{w}}&amp;=\frac{6+12i}{\sqrt{119}}</mrow>
            </md>.</p>
            <p>Then <xref ref="theorem-COB" acro="COB"/> guarantees that<md>
                <mrow>\colvector{2\\-3\\1\\4}&amp;=
                \frac{-5i}{\sqrt{6}}\left(\frac{1}{\sqrt{6}}\colvector{1+i\\1\\1-i\\i}\right)+
                \frac{-19+30i}{\sqrt{174}}\left(\frac{1}{\sqrt{174}}\colvector{1+5i\\6+5i\\-7-i\\1-6i}\right)</mrow>
                <mrow>&amp;\quad\quad+
                \frac{120-211i}{\sqrt{3451}}\left(\frac{1}{\sqrt{3451}}\colvector{-7+34i\\-8-23i\\-10+22i\\30+13i}\right)+
                \frac{6+12i}{\sqrt{119}}\left(\frac{1}{\sqrt{119}}\colvector{-2-4i\\6+i\\4+3i\\6-i}\right)</mrow>
            </md>as you might want to check (if you have unlimited patience).</p>
        </example>
        <p>A slightly less intimidating example follows, in three dimensions and with just real numbers.</p>
        <example xml:id="example-CROB3" acro="CROB3">
            <title>Coordinatization relative to an orthonormal basis, <m>\complex{3}</m></title>
            <idx>
                <h>coordinatization</h>
                <h>orthonormal basis</h>
            </idx>
            <p>The set<me>\set{\vect{x}_1,\,\vect{x}_2,\,\vect{x}_3}
            =\set{
            \colvector{1\\2\\1},\,
            \colvector{-1\\0\\1},\,
            \colvector{2\\1\\1}
            }</me>is a linearly independent set, which the Gram-Schmidt Process (<xref ref="theorem-GSP" acro="GSP"/>) converts to an orthogonal set, and which can then be converted to the orthonormal set,<me>B=
            \set{\vect{v}_1,\,\vect{v}_2,\,\vect{v}_3}
            =\set{
            \frac{1}{\sqrt{6}}\colvector{1\\2\\1},\,
            \frac{1}{\sqrt{2}}\colvector{-1\\0\\1},\,
            \frac{1}{\sqrt{3}}\colvector{1\\-1\\1}
            }</me>which is therefore an orthonormal basis of <m>\complex{3}</m>.  With three vectors in <m>\complex{3}</m>, all with real number entries, the inner product (<xref ref="definition-IP" acro="IP"/>) reduces to the usual <q>dot product</q> (or scalar product) and the orthogonal pairs of vectors can be interpreted as perpendicular pairs of directions.  So the vectors in <m>B</m> serve as replacements for our usual 3-D axes, or the usual 3-D unit vectors <m>\vec{i},\vec{j}</m> and <m>\vec{k}</m>.  We would like to decompose arbitrary vectors into <q>components</q> in the directions of each of these basis vectors.  It is <xref ref="theorem-COB" acro="COB"/> that tells us how to do this.</p>
            <p>Suppose that we choose <m>\vect{w}=\colvector{2\\-1\\5}</m>.  Compute<md>
                <mrow>\innerproduct{\vect{v}_1}{\vect{w}}=\frac{5}{\sqrt{6}}&amp;&amp;
                \innerproduct{\vect{v}_2}{\vect{w}}=\frac{3}{\sqrt{2}}&amp;&amp;
                \innerproduct{\vect{v}_3}{\vect{w}}=\frac{8}{\sqrt{3}}</mrow>
            </md>then <xref ref="theorem-COB" acro="COB"/> guarantees that<me>\colvector{2\\-1\\5}=
                \frac{5}{\sqrt{6}}\left(\frac{1}{\sqrt{6}}\colvector{1\\2\\1}\right)+
                \frac{3}{\sqrt{2}}\left(\frac{1}{\sqrt{2}}\colvector{-1\\0\\1}\right)+
                \frac{8}{\sqrt{3}}\left(\frac{1}{\sqrt{3}}\colvector{1\\-1\\1}\right)</me>which you should be able to check easily, even if you do not have much patience.</p>
        </example>
        <p>Not only do the columns of a unitary matrix form an orthonormal basis, but there is a deeper connection between orthonormal bases and unitary matrices.  Informally, the next theorem says that if we transform each vector of an orthonormal basis by multiplying it by a unitary matrix, then the resulting set will be another orthonormal basis.  And more remarkably, any matrix with this property must be unitary!  As an equivalence (Proof Technique<nbsp/><xref ref="technique-E" acro="E" text="global"/>) we could take this as our defining property of a unitary matrix, though it might not have the same utility as <xref ref="definition-UM" acro="UM"/>.</p>
        <theorem xml:id="theorem-UMCOB" acro="UMCOB">
            <title>Unitary Matrices Convert Orthonormal Bases</title>
            <idx>indexstring</idx>
            <statement>
                <p>Let <m>A</m> be an <m>n\times n</m> matrix and <m>B=\set{\vectorlist{x}{n}}</m> be an orthonormal basis of <m>\complex{n}</m>.  Define<me>C=\set{A\vect{x}_1,\,A\vect{x}_2,\,A\vect{x}_3,\,\dots,\,A\vect{x}_n}</me>.</p>
                <p>Then <m>A</m> is a unitary matrix if and only if <m>C</m> is an orthonormal basis of <m>\complex{n}</m>.</p>
            </statement>
            <proof>
                <case direction="forward">
                    <p> Assume <m>A</m> is a unitary matrix and establish several facts about <m>C</m>.  First we check that <m>C</m> is an orthonormal set (<xref ref="definition-ONS" acro="ONS"/>).  By <xref ref="theorem-UMPIP" acro="UMPIP"/>, for <m>i\neq j</m>,<md>
                        <mrow>\innerproduct{A\vect{x}_i}{A\vect{x}_j}&amp;
                        =\innerproduct{\vect{x}_i}{\vect{x}_j}=0</mrow>
                    </md>.</p>
                    <p>Similarly, <xref ref="theorem-UMPIP" acro="UMPIP"/> also gives, for <m>1\leq i\leq n</m>,<md>
                        <mrow>\norm{A\vect{x}_i}=\norm{\vect{x}_i}=1</mrow>
                    </md>.</p>
                    <p>As <m>C</m> is an orthogonal set (<xref ref="definition-OSV" acro="OSV"/>), <xref ref="theorem-OSLI" acro="OSLI"/> yields the linear independence of <m>C</m>.  Having established that the column vectors on <m>C</m> form a linearly independent set, a matrix whose columns are the vectors of <m>C</m> is nonsingular (<xref ref="theorem-NMLIC" acro="NMLIC"/>), and hence these vectors form a basis of <m>\complex{n}</m> by <xref ref="theorem-CNMB" acro="CNMB"/>.</p>
                <case direction="backward">
                </case>
                    <p>Now assume that <m>C</m> is an orthonormal set.  Let <m>\vect{y}</m> be an arbitrary vector from <m>\complex{n}</m>.  Since <m>B</m> spans <m>\complex{n}</m>, there are scalars, <m>\scalarlist{a}{n}</m>, such that<md>
                        <mrow>\vect{y}&amp;=a_1\vect{x}_1+a_2\vect{x}_2+a_3\vect{x}_3+\cdots+a_n\vect{x}_n</mrow>
                    </md>.</p>
                    <p>Now<md>
                        <mrow>\adjoint{A}A\vect{y}
                        &amp;=\sum_{i=1}^{n}\innerproduct{\vect{x}_i}{\adjoint{A}A\vect{y}}\vect{x}_i&amp;&amp;
                            <xref ref="theorem-COB" acro="COB"/></mrow>
                        <mrow>&amp;=\sum_{i=1}^{n}\innerproduct{\vect{x}_i}{\adjoint{A}A\sum_{j=1}^{n}a_j\vect{x}_j}\vect{x}_i&amp;&amp;
                            <xref ref="definition-SSVS" acro="SSVS"/></mrow>
                        <mrow>&amp;=\sum_{i=1}^{n}\innerproduct{\vect{x}_i}{\sum_{j=1}^{n}\adjoint{A}Aa_j\vect{x}_j}\vect{x}_i&amp;&amp;
                            <xref ref="theorem-MMDAA" acro="MMDAA"/></mrow>
                        <mrow>&amp;=\sum_{i=1}^{n}\innerproduct{\vect{x}_i}{\sum_{j=1}^{n}a_j\adjoint{A}A\vect{x}_j}\vect{x}_i&amp;&amp;
                            <xref ref="theorem-MMSMM" acro="MMSMM"/></mrow>
                        <mrow>&amp;=\sum_{i=1}^{n}\sum_{j=1}^{n}\innerproduct{\vect{x}_i}{a_j\adjoint{A}A\vect{x}_j}\vect{x}_i&amp;&amp;
                            <xref ref="theorem-IPVA" acro="IPVA"/></mrow>
                        <mrow>&amp;=\sum_{i=1}^{n}\sum_{j=1}^{n}a_j\innerproduct{\vect{x}_i}{\adjoint{A}A\vect{x}_j}\vect{x}_i&amp;&amp;
                            <xref ref="theorem-IPSM" acro="IPSM"/></mrow>
                        <mrow>&amp;=\sum_{i=1}^{n}\sum_{j=1}^{n}a_j\innerproduct{A\vect{x}_i}{A\vect{x}_j}\vect{x}_i&amp;&amp;
                            <xref ref="theorem-AIP" acro="AIP"/></mrow>
                        <mrow>&amp;=
                        \sum_{i=1}^{n}\sum_{\substack{j=1\\j\neq i}}^{n}a_j\innerproduct{A\vect{x}_i}{A\vect{x}_j}\vect{x}_i
                        +
                        \sum_{\ell=1}^{n}a_\ell\innerproduct{A\vect{x}_\ell}{A\vect{x}_\ell}\vect{x}_\ell&amp;&amp;
                            <xref ref="property-C" acro="C"/></mrow>
                        <mrow>&amp;=
                        \sum_{i=1}^{n}\sum_{\substack{j=1\\j\neq i}}^{n}a_j(0)\vect{x}_i
                        +
                        \sum_{\ell=1}^{n}a_\ell(1)\vect{x}_\ell&amp;&amp;
                            <xref ref="definition-ONS" acro="ONS"/></mrow>
                        <mrow>&amp;=
                        \sum_{i=1}^{n}\sum_{\substack{j=1\\j\neq i}}^{n}\zerovector
                        +
                        \sum_{\ell=1}^{n}a_\ell\vect{x}_\ell&amp;&amp;
                            <xref ref="theorem-ZSSM" acro="ZSSM"/></mrow>
                        <mrow>&amp;=\sum_{\ell=1}^{n}a_\ell\vect{x}_\ell&amp;&amp;
                            <xref ref="property-Z" acro="Z"/></mrow>
                        <mrow>&amp;=\vect{y}</mrow>
                        <mrow>&amp;=I_n\vect{y}&amp;&amp;
                            <xref ref="theorem-MMIM" acro="MMIM"/></mrow>
                    </md>.</p>
                    <p>Since the choice of <m>\vect{y}</m> was arbitrary, <xref ref="theorem-EMMVP" acro="EMMVP"/> tells us that <m>\adjoint{A}A=I_n</m>, so <m>A</m> is unitary (<xref ref="definition-UM" acro="UM"/>).</p>
                </case>
            </proof>
        </theorem>
        <computation xml:id="sage-C" acro="C">
            <title>Coordinates</title>
            <idx>coordinates</idx>
            <p>For vector spaces of column vectors, Sage can quickly determine the coordinates of a vector relative to a basis, as guaranteed by <xref ref="theorem-VRRB" acro="VRRB"/>.  We illustrate some new Sage commands with a simple example and then apply them to orthonormal bases.  The vectors <c>v1</c> and <c>v2</c> are linearly independent and thus span a subspace with a basis of size 2.  We first create this subspace and let Sage determine the basis, then we illustrate a new vector space method, <c>.subspace_with_basis()</c>, that allows us to specify the basis.  (This method is very similar to <c>.span_of_basis()</c>, except it preserves a subspace relationship with the original vector space.)  Notice how the description of the vector space makes it clear that <c>W</c> has a user-specified basis.  Notice too that the actual subspace created is the same in both cases.</p>
            <sage xml:id="sagecell-C-1">
                <input>
                V = QQ^3
                v1 = vector(QQ,[ 2, 1, 3])
                v2 = vector(QQ,[-1, 1, 4])
                U=V.span([v1,v2])
                U
                </input>
                <output>
                Vector space of degree 3 and dimension 2 over Rational Field
                Basis matrix:
                [   1    0 -1/3]
                [   0    1 11/3]
                </output>
            </sage>
            <sage xml:id="sagecell-C-2">
                <input>
                W = V.subspace_with_basis([v1, v2])
                W
                </input>
                <output>
                Vector space of degree 3 and dimension 2 over Rational Field
                User basis matrix:
                [ 2  1  3]
                [-1  1  4]
                </output>
            </sage>
            <sage xml:id="sagecell-C-3">
                <input>
                U == W
                </input>
                <output>
                True
                </output>
            </sage>
            <p>Now we manufacture a third vector in the subspace, and request a coordinatization in each vector space, which has the effect of using a different basis in each case.  The vector space method <c>.coordinate_vector(v)</c> computes a vector whose entries express <c>v</c> as a linear combination of basis vectors.  Verify for yourself in each case below that the components of the vector returned really give a linear combination of the basis vectors that equals <c>v3</c>.</p>
            <sage xml:id="sagecell-C-4">
                <input>
                v3 = 4*v1 + v2; v3
                </input>
                <output>
                (7, 5, 16)
                </output>
            </sage>
            <sage xml:id="sagecell-C-5">
                <input>
                U.coordinate_vector(v3)
                </input>
                <output>
                (7, 5)
                </output>
            </sage>
            <sage xml:id="sagecell-C-6">
                <input>
                W.coordinate_vector(v3)
                </input>
                <output>
                (4, 1)
                </output>
            </sage>
            <p>Now we can construct a more complicated example using an orthonormal basis, specifically the one from <xref ref="example-CROB4" acro="CROB4"/>, but we will compute over <c>QQbar</c>, the field of algebraic numbers.  We form the four vectors of the orthonormal basis, install them as the basis of a vector space and then ask for the coordinates.  Sage treats the square roots in the scalars as <q>symbolic</q> expressions, so we need to explicitly coerce them into <c>QQbar</c> before computing the scalar multiples.</p>
            <sage xml:id="sagecell-C-7">
                <input>
                V = QQbar^4
                x1 = vector(QQbar, [    1+I,       1,      1-I,       I])
                x2 = vector(QQbar, [  1+5*I,   6+5*I,     -7-I,   1-6*I])
                x3 = vector(QQbar, [-7+34*I, -8-23*I, -10+22*I, 30+13*I])
                x4 = vector(QQbar, [ -2-4*I,     6+I,    4+3*I,     6-I])
                v1 = QQbar(1/sqrt(6))   * x1
                v2 = QQbar(1/sqrt(174)) * x2
                v3 = QQbar(1/sqrt(3451))* x3
                v4 = QQbar(1/sqrt(119)) * x4
                W = V.subspace_with_basis([v1, v2, v3, v4])
                w = vector(QQbar, [2, -3, 1, 4])
                c = W.coordinate_vector(w); c
                </input>
                <output>
                (0.?e-15 - 2.04124145231932?*I,
                -1.44038628279992? + 2.27429413073671?*I,
                2.04271964894459? - 3.59178204939423?*I,
                0.550019098216927? + 1.100038196433854?*I)
                </output>
            </sage>
            <p>Is this right?  Our exact coordinates in the text are <em>displayed</em> differently, but we can check that they really are the same numbers:</p>
            <sage xml:id="sagecell-C-8">
                <input>
                c[0] == QQbar(1/sqrt(6)*(-5*I))
                </input>
                <output>
                True
                </output>
            </sage>
            <sage xml:id="sagecell-C-9">
                <input>
                c[1] == QQbar(1/sqrt(174)*(-19+30*I))
                </input>
                <output>
                True
                </output>
            </sage>
            <sage xml:id="sagecell-C-10">
                <input>
                c[2] == QQbar(1/sqrt(3451)*(120-211*I))
                </input>
                <output>
                True
                </output>
            </sage>
            <sage xml:id="sagecell-C-11">
                <input>
                c[3] == QQbar(1/sqrt(119)*(6+12*I))
                </input>
                <output>
                True
                </output>
            </sage>
            <p>With an orthonormal basis, we can illustrate <xref ref="theorem-CUMOS" acro="CUMOS"/> by making the four vectors the columns of <m>4\times 4</m> matrix and verifying the result is a unitary matrix.</p>
            <sage xml:id="sagecell-C-12">
                <input>
                U = column_matrix([v1, v2, v3, v4])
                U.is_unitary()
                </input>
                <output>
                True
                </output>
            </sage>
            <p>We will see coordinate vectors again, in a more formal setting, in Sage<nbsp/><xref ref="sage-VR" acro="VR" text="global"/>.</p>
        </computation>
    </subsection>
    <!--   End  b.tex -->
    <reading-questions xml:id="readingquestions-B">
        <exercise component="fcla-rq" xml:id="reading-B-1" label="reading-B-1">
            <title>Columns of a nonsingular matrix</title>
            <statement>
                <p>The matrix below is nonsingular.  What can you now say about its columns?<me>A=\begin{bmatrix}
                -3 &amp; 0 &amp; 1\\
                1 &amp; 2 &amp; 1\\
                5 &amp; 1 &amp; 6
                \end{bmatrix}</me></p>
            </statement>
            <response/>
        </exercise>
        <exercise component="fcla-rq" xml:id="reading-B-2" label="reading-B-2">
            <title>Linear combination of columns</title>
            <statement>
                <p>Write the vector <m>\vect{w}=\colvector{6\\6\\15}</m> as a linear combination of the columns of the matrix <m>A</m> above.  How many ways are there to answer this question?</p>
            </statement>
            <response/>
        </exercise>
        <exercise component="fcla-rq" xml:id="reading-B-3" label="reading-B-3">
            <title>Why desire orthonormal?</title>
            <statement>
                <p>Why is an orthonormal basis desirable?</p>
            </statement>
            <response/>
        </exercise>
    </reading-questions>
    <exercises xml:id="exercises-B">
        <title>Exercises</title>
        <exercise number="C10" xml:id="exercise-B-C10">
            <statement contributor="chrisblack">
                <p>Find a basis for <m>\spn{S}</m>, where<md>
                    <mrow>S &amp;= \set{
                    \colvector{1\\3\\2\\1},
                    \colvector{1\\2\\1\\1},
                    \colvector{1\\1\\0\\1},
                    \colvector{1\\2\\2\\1},
                    \colvector{3\\4\\1\\3}
                    }</mrow>
                </md>.</p>
            </statement>
            <solution xml:id="solution-B-C10" contributor="chrisblack">
                <p><xref ref="theorem-BS" acro="BS"/> says that if we take these 5 vectors, put them into a matrix, and row-reduce to discover the pivot columns, then the vectors of <m>S</m> with the same column indices will be linearly independent and span <m>S</m>, and thus will form a basis of <m>S</m>.<md>
                    <mrow>\begin{bmatrix}
                    1 &amp; 1 &amp; 1 &amp; 1 &amp; 3\\
                    3 &amp; 2 &amp; 1 &amp; 2 &amp; 4\\
                    2 &amp; 1 &amp; 0 &amp; 2 &amp; 1\\
                    1 &amp; 1 &amp; 1 &amp; 1 &amp; 3
                    \end{bmatrix}
                    &amp;\rref
                    \begin{bmatrix}
                    \leading{1} &amp; 0 &amp; -1 &amp; 0 &amp; -2\\
                    0 &amp; \leading{1} &amp; 2 &amp; 0 &amp; 5\\
                    0 &amp; 0 &amp; 0 &amp; \leading{1} &amp; 0\\
                    0 &amp; 0 &amp; 0 &amp; 0 &amp;0
                    \end{bmatrix}</mrow>
                </md>Since columns 1, 2, and 4 are pivot columns, the vectors that span <m>S</m> are the first, second and fourth of the set, so a basis of <m>S</m> is<md>
                    <mrow>B &amp;= \set{
                    \colvector{1\\3\\2\\1},
                    \colvector{1\\2\\1\\1},
                    \colvector{1\\2\\2\\1}
                    }</mrow>
                </md>.</p>
            </solution>
        </exercise>
        <exercise number="C11" xml:id="exercise-B-C11">
            <statement contributor="chrisblack">
                <p>Find a basis for the subspace <m>W</m> of <m>\complex{4}</m>,<md>
                    <mrow>W &amp;=
                    \setparts{\colvector{a + b - 2c\\a + b - 2c + d\\ -2a + 2b + 4c - d\\ b + d}}
                    {a, b, c, d \in\complexes}</mrow>
                </md>.</p>
            </statement>
            <solution xml:id="solution-B-C11" contributor="chrisblack">
                <p>We can rewrite an arbitrary vector of <m>W</m> as<md>
                    <mrow>\colvector{a + b - 2c\\ a + b - 2c + d\\ -2a + 2b + 4c - d\\ b + d}
                    &amp; = \colvector{a\\a\\-2a\\0} +
                    \colvector{b\\b\\2b\\b} +
                    \colvector{-2c\\-2c\\4c\\0} +
                    \colvector{0\\d\\-d\\d}</mrow>
                    <mrow>&amp;= a\colvector{1\\1\\-2\\0} +
                    b\colvector{1\\1\\2\\1} +
                    c\colvector{-2\\-2\\4\\0} +
                    d\colvector{0\\1\\-1\\1}</mrow>
                </md>Thus, we can write <m>W</m> as<md>
                    <mrow>W &amp;= \spn{\set{
                    \colvector{1\\1\\-2\\0},
                    \colvector{1\\1\\2\\1},
                    \colvector{-2\\-2\\4\\0},
                    \colvector{0\\1\\-1\\1}
                    }}</mrow>
                </md>.  These four vectors span <m>W</m>, but we also need to determine if they are linearly independent (turns out they are not).  With an application of <xref ref="theorem-BS" acro="BS"/> we can see that the arrive at a basis employing three of these vectors,<md>
                    <mrow>\begin{bmatrix}
                    1 &amp; 1 &amp; -2 &amp; 0\\
                    1 &amp; 1 &amp; -2 &amp; 1\\
                    -2 &amp; 2 &amp; 4 &amp; -1\\
                    0 &amp; 1 &amp; 0 &amp; 1
                    \end{bmatrix}
                    &amp;\rref
                    \begin{bmatrix}
                    \leading{1} &amp; 0 &amp; -2 &amp; 0\\
                    0 &amp; \leading{1} &amp; 0 &amp; 0\\
                    0 &amp; 0 &amp; 0 &amp; \leading{1}\\
                    0 &amp; 0 &amp; 0 &amp;0
                    \end{bmatrix}</mrow>
                </md>Thus, we have the following basis of <m>W</m>,<md>
                    <mrow>B &amp;= \set{
                    \colvector{1\\1\\-2\\0},
                    \colvector{1\\1\\2\\1},
                    \colvector{0\\1\\-1\\1}
                    }</mrow>
                </md>.</p>
            </solution>
        </exercise>
        <exercise number="C12" xml:id="exercise-B-C12">
            <statement contributor="chrisblack">
                <p>Find a basis for the vector space <m>T</m> of lower triangular <m>3 \times 3</m> matrices; that is, matrices of the form<md>
                    <mrow>\begin{bmatrix} * &amp; 0 &amp; 0\\ * &amp; * &amp; 0\\ * &amp; * &amp; *\end{bmatrix}</mrow>
                </md>where an asterisk represents any complex number (see <xref ref="definition-LTM"/>).</p>
            </statement>
            <solution xml:id="solution-B-C12" contributor="chrisblack">
                <p>Let <m>A</m> be an arbitrary element of the specified vector space <m>T</m>.  Then there exist <m>a</m>, <m>b</m>, <m>c</m>, <m>d</m>, <m>e</m> and <m>f</m> so that<md>
                    <mrow>A = \begin{bmatrix} a &amp; 0 &amp; 0\\ b &amp;  c &amp; 0\\ d &amp; e &amp; f \end{bmatrix}</mrow>
                </md>.  Then<md>
                    <mrow>A &amp;=
                    a\begin{bmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0\\ 0  &amp; 0 &amp; 0 \end{bmatrix} +
                    b\begin{bmatrix} 0 &amp; 0 &amp; 0 \\ 1 &amp; 0 &amp; 0\\ 0  &amp; 0 &amp; 0 \end{bmatrix} +
                    c\begin{bmatrix} 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0\\ 0  &amp; 0 &amp; 0 \end{bmatrix} +
                    d\begin{bmatrix} 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0\\ 1  &amp; 0 &amp; 0 \end{bmatrix} +
                    e\begin{bmatrix} 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0\\ 0  &amp; 1 &amp; 0 \end{bmatrix} +
                    f\begin{bmatrix} 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0\\ 0  &amp; 0 &amp; 1 \end{bmatrix}</mrow>
                </md>Consider the set<md>
                    <mrow>B &amp;= \set{
                    \begin{bmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0\\ 0  &amp; 0 &amp; 0 \end{bmatrix},
                    \begin{bmatrix} 0 &amp; 0 &amp; 0 \\ 1 &amp; 0 &amp; 0\\ 0  &amp; 0 &amp; 0 \end{bmatrix},
                    \begin{bmatrix} 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0\\ 0  &amp; 0 &amp; 0 \end{bmatrix},
                    \begin{bmatrix} 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0\\ 1  &amp; 0 &amp; 0 \end{bmatrix},
                    \begin{bmatrix} 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0\\ 0  &amp; 1 &amp; 0 \end{bmatrix},
                    \begin{bmatrix} 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0\\ 0  &amp; 0 &amp; 1 \end{bmatrix}
                    }</mrow>
                </md>The six vectors in <m>B</m> span the  vector space <m>T</m>, and we can check rather simply that they are also linearly independent.  Thus, <m>B</m> is a basis of <m>T</m>.</p>
            </solution>
        </exercise>
        <exercise number="C13" xml:id="exercise-B-C13">
            <statement contributor="chrisblack">
                <p>Find a basis for the subspace <m>Q</m> of <m>P_2</m>, <m>Q = \setparts{p(x) = a + bx + cx^2}{p(0) = 0}</m>.</p>
            </statement>
            <solution xml:id="solution-B-C13" contributor="chrisblack">
                <p>If <m>p(0) = 0</m>, then <m>a + b(0) + c(0^2) = 0</m>, so <m>a = 0</m>.  Thus, we can write <m>Q = \setparts{p(x) = bx + cx^2}{b, c\in\complexes}</m>.  A linearly independent set that spans <m>Q</m> is <m>B=\set{x, x^2}</m>, and this set forms a basis of <m>Q</m>.</p>
            </solution>
        </exercise>
        <exercise number="C14" xml:id="exercise-B-C14">
            <statement contributor="chrisblack">
                <p>Find a basis for the subspace <m>R</m> of <m>P_2</m>, <m>R = \setparts{p(x) = a + bx + cx^2}{p'(0) = 0}</m>, where <m>p'</m> denotes the derivative.</p>
            </statement>
            <solution xml:id="solution-B-C14" contributor="chrisblack">
                <p>The derivative of <m>p(x) = a + bx + cx^2</m> is <m>p^\prime(x) = b + 2cx</m>.  Thus, if <m>p \in R</m>, then <m>p^\prime(0) = b + 2c(0) = 0</m>,  so we must have <m>b = 0</m>.  We see that we can rewrite <m>R</m> as <m>R = \setparts{p(x) = a + cx^2}{a, c\in\complexes}</m>.  A linearly independent set that spans <m>R</m> is <m>B = \set{1,x^2}</m>, and <m>B</m> is a basis of <m>R</m>.</p>
            </solution>
        </exercise>
        <exercise number="C40" xml:id="exercise-B-C40">
            <statement>
                <p>From <xref ref="example-RSB" acro="RSB"/>, form an arbitrary (and nontrivial) linear combination of the four vectors in the original spanning set for <m>W</m>.  So the result of this computation is of course an element of <m>W</m>.  As such, this vector should be a linear combination of the basis vectors in <m>B</m>.  Find the (unique) scalars that provide this linear combination.  Repeat with another linear combination of the original four vectors.</p>
            </statement>
            <solution xml:id="solution-B-C40">
                <p>An arbitrary linear combination is<me>\vect{y}=
                3\colvector{2\\-3\\1}+
                (-2)\colvector{1\\4\\1}+
                1\colvector{7\\-5\\4}+
                (-2)\colvector{-7\\-6\\-5}
                =
                \colvector{25\\-10\\15}</me>.  (You probably used a different collection of scalars.)  We want to write <m>\vect{y}</m> as a linear combination of<me>B=\set{\colvector{1\\0\\\frac{7}{11}},\,\colvector{0\\1\\\frac{1}{11}}}</me>We could set this up as vector equation with variables as scalars in a linear combination of the vectors in <m>B</m>, but since the first two slots of <m>B</m> have such a nice pattern of zeros and ones, we can determine the necessary scalars easily and then double-check our answer with a computation in the third slot,<me>25\colvector{1\\0\\\frac{7}{11}}+(-10)\colvector{0\\1\\\frac{1}{11}}
                =
                \colvector{25\\-10\\(25)\frac{7}{11}+(-10)\frac{1}{11}}
                =
                \colvector{25\\-10\\15}=\vect{y}</me>.  Notice how the uniqueness of these scalars arises.  They are <em>forced</em> to be <m>25</m> and <m>-10</m>.</p>
            </solution>
        </exercise>
        <exercise number="C80" xml:id="exercise-B-C80">
            <statement>
                <p>Prove that <m>\set{(1,\,2),\,(2,\,3)}</m> is a basis for the crazy vector space <m>C</m> (<xref ref="example-CVS" acro="CVS"/>).</p>
            </statement>
        </exercise>
        <exercise number="M20" xml:id="exercise-B-M20">
            <statement>
                <p>In <xref ref="example-BM" acro="BM"/> provide the verifications (linear independence and spanning) to show that <m>B</m> is a basis of <m>M_{mn}</m>.</p>
            </statement>
            <solution xml:id="solution-B-M20">
                <p>We need to establish the linear independence and spanning properties of the set<me>B=\setparts{B_{k\ell}}{1\leq k\leq m,\ 1\leq\ell\leq n}</me>relative to the vector space <m>M_{mn}</m>.</p>
                <p>This proof is more transparent if you write out individual matrices in the basis with lots of zeros and dots and a lone one.  But we do not have room for that here, so we will use summation notation.  Think carefully about each step, especially when the double summations seem to <q>disappear.</q>  Begin with a relation of linear dependence, using double subscripts on the scalars to align with the basis elements.<me>\zeromatrix=\sum_{k=1}^{m}\sum_{\ell=1}^{n}\alpha_{k\ell}B_{k\ell}</me>Now consider the entry in row <m>i</m> and column <m>j</m> for these equal matrices,<md>
                    <mrow>0
                    &amp;=\matrixentry{\zeromatrix}{ij}&amp;&amp;
                        <xref ref="definition-ZM" acro="ZM"/></mrow>
                    <mrow>&amp;=\matrixentry{\sum_{k=1}^{m}\sum_{\ell=1}^{n}\alpha_{k\ell}B_{k\ell}}{ij}&amp;&amp;
                        <xref ref="definition-ME" acro="ME"/></mrow>
                    <mrow>&amp;=\sum_{k=1}^{m}\sum_{\ell=1}^{n}\matrixentry{\alpha_{k\ell}B_{k\ell}}{ij}&amp;&amp;
                        <xref ref="definition-MA" acro="MA"/></mrow>
                    <mrow>&amp;=\sum_{k=1}^{m}\sum_{\ell=1}^{n}\alpha_{k\ell}\matrixentry{B_{k\ell}}{ij}&amp;&amp;
                        <xref ref="definition-MSM" acro="MSM"/></mrow>
                    <mrow>&amp;=\alpha_{ij}\matrixentry{B_{ij}}{ij}&amp;&amp;
                        \matrixentry{B_{k\ell}}{ij}=0\text{ when }(k,\ell)\neq(i,j)</mrow>
                    <mrow>&amp;=\alpha_{ij}(1)&amp;&amp;
                        \matrixentry{B_{ij}}{ij}=1</mrow>
                    <mrow>&amp;=\alpha_{ij}</mrow>
                </md>.  Since <m>i</m> and <m>j</m> were arbitrary, we find that each scalar is zero and so <m>B</m> is linearly independent (<xref ref="definition-LI" acro="LI"/>).</p>
                <p>To establish the spanning property of <m>B</m> we need only show that an arbitrary matrix <m>A</m> can be written as a linear combination of the elements of <m>B</m>.  So suppose that <m>A</m> is an arbitrary <m>m\times n</m> matrix and consider the matrix <m>C</m> defined as a linear combination of the elements of <m>B</m> by<me>C=\sum_{k=1}^{m}\sum_{\ell=1}^{n}\matrixentry{A}{k\ell}B_{k\ell}</me>Then,<md>
                    <mrow>\matrixentry{C}{ij}
                    &amp;=\matrixentry{\sum_{k=1}^{m}\sum_{\ell=1}^{n}\matrixentry{A}{k\ell}B_{k\ell}}{ij}&amp;&amp;
                        <xref ref="definition-ME" acro="ME"/></mrow>
                    <mrow>&amp;=\sum_{k=1}^{m}\sum_{\ell=1}^{n}\matrixentry{\matrixentry{A}{k\ell}B_{k\ell}}{ij}&amp;&amp;
                        <xref ref="definition-MA" acro="MA"/></mrow>
                    <mrow>&amp;=\sum_{k=1}^{m}\sum_{\ell=1}^{n}\matrixentry{A}{k\ell}\matrixentry{B_{k\ell}}{ij}&amp;&amp;
                        <xref ref="definition-MSM" acro="MSM"/></mrow>
                    <mrow>&amp;=\matrixentry{A}{ij}\matrixentry{B_{ij}}{ij}&amp;&amp;
                        \matrixentry{B_{k\ell}}{ij}=0\text{ when }(k,\ell)\neq(i,j)</mrow>
                    <mrow>&amp;=\matrixentry{A}{ij}(1)&amp;&amp;
                        \matrixentry{B_{ij}}{ij}=1</mrow>
                    <mrow>&amp;=\matrixentry{A}{ij}</mrow>
                </md>So by <xref ref="definition-ME" acro="ME"/>, <m>A=C</m>, and therefore <m>A\in\spn{B}</m>.  By <xref ref="definition-B" acro="B"/>, the set <m>B</m> is a basis of the vector space <m>M_{mn}</m>.</p>
            </solution>
        </exercise>
        <exercise number="T50" xml:id="exercise-B-T50">
            <statement>
                <p><xref ref="theorem-UMCOB" acro="UMCOB"/> says that unitary matrices are characterized as those matrices that <q>carry</q> orthonormal bases to orthonormal bases.  This problem asks you to prove a similar result:  nonsingular matrices are characterized as those matrices that <q>carry</q> bases to bases.</p>
                <p>More precisely, suppose that <m>A</m> is a square matrix of size <m>n</m> and <m>B=\set{\vectorlist{x}{n}}</m> is a basis of <m>\complex{n}</m>.  Prove that <m>A</m> is nonsingular if and only if <m>C=\set{A\vect{x}_1,\,A\vect{x}_2,\,A\vect{x}_3,\,\dots,\,A\vect{x}_n}</m> is a basis of <m>\complex{n}</m>.  (See also <xref ref="exercise-PD-T33" acro="PD.T33"/>, <xref ref="exercise-MR-T20" acro="MR.T20"/>.)</p>
            </statement>
            <solution xml:id="solution-B-T50">
                <p>Our first proof relies mostly on definitions of linear independence and spanning, which is a good exercise.  The second proof is shorter and turns on a technical result from our work with matrix inverses, <xref ref="theorem-NPNF" acro="NPNF"/>.</p>
                <proof>
                    <case direction="forward">
                        <p>Assume that <m>A</m> is nonsingular and prove that <m>C</m> is a basis of <m>\complex{n}</m>.  First show that <m>C</m> is linearly independent.  Work on a relation of linear dependence on <m>C</m>,<md>
                            <mrow>\zerovector
                            &amp;=
                            a_1A\vect{x}_1+
                            a_2A\vect{x}_2+
                            a_3A\vect{x}_3+
                            \cdots+
                            a_nA\vect{x}_n&amp;&amp;
                                <xref ref="definition-RLD" acro="RLD"/></mrow>
                            <mrow>&amp;=
                            Aa_1\vect{x}_1+
                            Aa_2\vect{x}_2+
                            Aa_3\vect{x}_3+
                            \cdots+
                            Aa_n\vect{x}_n&amp;&amp;
                                <xref ref="theorem-MMSMM" acro="MMSMM"/></mrow>
                            <mrow>&amp;=
                            A\left(
                            a_1\vect{x}_1+
                            a_2\vect{x}_2+
                            a_3\vect{x}_3+
                            \cdots+
                            a_n\vect{x}_n
                            \right)&amp;&amp;
                                <xref ref="theorem-MMDAA" acro="MMDAA"/></mrow>
                        </md>Since <m>A</m> is nonsingular, <xref ref="definition-NM" acro="NM"/> and <xref ref="theorem-SLEMM" acro="SLEMM"/> allows us to conclude that<md>
                            <mrow>a_1\vect{x}_1+
                            a_2\vect{x}_2+
                            \cdots+
                            a_n\vect{x}_n
                            &amp;=\zerovector</mrow>
                        </md>But this is a relation of linear dependence of the linearly independent set <m>B</m>, so the scalars are trivial, <m>a_1=a_2=a_3=\cdots=a_n=0</m>.  By <xref ref="definition-LI" acro="LI"/>, the set <m>C</m> is linearly independent.</p>
                        <p>Now prove that <m>C</m> spans <m>\complex{n}</m>.  Given an arbitrary vector <m>\vect{y}\in\complex{n}</m>, can it be expressed as a linear combination of the vectors in <m>C</m>?  Since <m>A</m> is a nonsingular matrix we can define the vector <m>\vect{w}</m> to be the unique solution of the system <m>\linearsystem{A}{\vect{y}}</m> (<xref ref="theorem-NMUS" acro="NMUS"/>).  Since <m>\vect{w}\in\complex{n}</m> we can write <m>\vect{w}</m> as a linear combination of the vectors in the basis <m>B</m>.  So there are scalars, <m>\scalarlist{b}{n}</m> such that<md>
                            <mrow>\vect{w}&amp;=\lincombo{b}{x}{n}</mrow>
                        </md>.  Then,<md>
                            <mrow>\vect{y}
                            &amp;=A\vect{w}&amp;&amp;
                                <xref ref="theorem-SLEMM" acro="SLEMM"/></mrow>
                            <mrow>&amp;=A\left(\lincombo{b}{x}{n}\right)&amp;&amp;
                                <xref ref="definition-SSVS" acro="SSVS"/></mrow>
                            <mrow>&amp;=
                            Ab_1\vect{x}_1+
                            Ab_2\vect{x}_2+
                            Ab_3\vect{x}_3+
                            \cdots+
                            Ab_n\vect{x}_n&amp;&amp;
                                <xref ref="theorem-MMDAA" acro="MMDAA"/></mrow>
                            <mrow>&amp;=
                            b_1A\vect{x}_1+
                            b_2A\vect{x}_2+
                            b_3A\vect{x}_3+
                            \cdots+
                            b_nA\vect{x}_n&amp;&amp;
                                <xref ref="theorem-MMSMM" acro="MMSMM"/></mrow>
                        </md>So we can write an arbitrary vector of <m>\complex{n}</m> as a linear combination of the elements of <m>C</m>.  In other words, <m>C</m> spans <m>\complex{n}</m> (<xref ref="definition-SSVS" acro="SSVS"/>).  By <xref ref="definition-B" acro="B"/>, the set <m>C</m> is a basis for <m>\complex{n}</m>.</p>
                    </case>
                    <case direction="backward">
                        <p>Assume that <m>C</m> is a basis and prove that <m>A</m> is nonsingular.  Let <m>\vect{x}</m> be a solution to the homogeneous system <m>\homosystem{A}</m>.  Since <m>B</m> is a basis of <m>\complex{n}</m> there are  scalars, <m>\scalarlist{a}{n}</m>, such that<md>
                            <mrow>\vect{x}&amp;=\lincombo{a}{x}{n}</mrow>
                        </md>Then<md>
                            <mrow>\zerovector
                            &amp;=A\vect{x}&amp;&amp;
                                <xref ref="theorem-SLEMM" acro="SLEMM"/></mrow>
                            <mrow>&amp;=A\left(\lincombo{a}{x}{n}\right)&amp;&amp;
                                <xref ref="definition-SSVS" acro="SSVS"/></mrow>
                            <mrow>&amp;=
                            Aa_1\vect{x}_1+
                            Aa_2\vect{x}_2+
                            Aa_3\vect{x}_3+
                            \cdots+
                            Aa_n\vect{x}_n&amp;&amp;
                                <xref ref="theorem-MMDAA" acro="MMDAA"/></mrow>
                            <mrow>&amp;=
                            a_1A\vect{x}_1+
                            a_2A\vect{x}_2+
                            a_3A\vect{x}_3+
                            \cdots+
                            a_nA\vect{x}_n&amp;&amp;
                                <xref ref="theorem-MMSMM" acro="MMSMM"/></mrow>
                        </md>This is a relation of linear dependence on the linearly independent set <m>C</m>, so the scalars must all be zero, <m>a_1=a_2=a_3=\cdots=a_n=0</m>.  Thus,<md>
                            <mrow>\vect{x}&amp;=\lincombo{a}{x}{n}=0\vect{x}_1+0\vect{x}_2+0\vect{x}_3+\cdots+0\vect{x}_n=\zerovector</mrow>
                        </md>.  By <xref ref="definition-NM" acro="NM"/> we see that <m>A</m> is nonsingular.</p>
                    </case>
                </proof>
                <proof>
                    <p>Now for a second proof.  Take the vectors for <m>B</m> and use them as the columns of a matrix, <m>G=\matrixcolumns{x}{n}</m>.  By <xref ref="theorem-CNMB" acro="CNMB"/>, because we have the hypothesis that <m>B</m> is a basis of <m>\complex{n}</m>, <m>G</m> is a nonsingular matrix.  Notice that the columns of <m>AG</m> are exactly the vectors in the set <m>C</m>, by <xref ref="definition-MM" acro="MM"/>.<md>
                        <mrow>A\text{ nonsingular}
                        &amp;\iff AG\text{ nonsingular}&amp;&amp;
                            <xref ref="theorem-NPNF" acro="NPNF"/></mrow>
                        <mrow>&amp;\iff C\text{ basis for }\complex{n}&amp;&amp;
                            <xref ref="theorem-CNMB" acro="CNMB"/></mrow>
                    </md>That was easy!</p>
                </proof>
            </solution>
        </exercise>
        <exercise number="T51" xml:id="exercise-B-T51">
            <statement>
                <p>Use the result of <xref ref="exercise-B-T50" acro="B.T50"/> to build a very concise proof of <xref ref="theorem-CNMB" acro="CNMB"/>.  (Hint: make a judicious choice for the basis <m>B</m>.)</p>
            </statement>
            <solution xml:id="solution-B-T51">
                <p>Choose <m>B</m> to be the set of standard unit vectors, a particularly nice basis of <m>\complex{n}</m> (<xref ref="theorem-SUVB" acro="SUVB"/>).  For a vector <m>\vect{e}_j</m> (<xref ref="definition-SUV" acro="SUV"/>) from this basis, what is <m>A\vect{e}_j</m>?</p>
            </solution>
        </exercise>
    </exercises>
</section>
